Type.registerNamespace("Telerik.Web.UI");
Type.registerNamespace("Telerik.Web.UI.Editor");
(function(b,a){b.TrackChangesConstants={CssClassInsert:"Change_Insert",CssClassDelete:"Change_Delete",CssClassComment:"reComment",CssClassFormat:"reFormat",CssClassDeletTR:"Delete_TR",CssClassInsertTR:"Insert_TR",CssClass:"trackchanges_curr_rev",CssClassNamePrefixComment:"reComment",CssClassNamePrefixFormat:"reFormat",CssClassNamePrefixInsertTR:"reIns",CssClassNamePrefixDeleteTR:"reDel",TagInsert:"ins",TagDelete:"del",TagComment:"font",TagFormat:"font",Attribute:{Title:"title",Timestamp:"timestamp",Cite:"cite",BrowserCommand:"browsercommand",Author:"author",Comment:"comment"},CommentsRegex:new RegExp("reComment","ig"),InsTagMatchRegex:new RegExp("<ins[^>]*>.*","i"),DelTagMatchRegex:new RegExp("<del[^>]*>.*","i"),BlockTagMatchRegex:new RegExp("<(?:p|div)[^>]*>.*?</(?:p|div)>","i"),JustifyBlockTags:"|div|p|"};
b.TrackChangesCommandStrings={AcceptTrackChange:"Accept Trackchange",RejectTrackChange:"Reject TrackChange",RemoveTrackChange:"Remove TrackChange",AddComment:"Add Comment",RemoveComment:"Remove Comment",TrackChange:"Apply TrackChange",Delete:"Delete"};
a.registerEnum(b,"SelectionType",{Text:0,Control:1,Range:2});
a.registerEnum(b,"TrackChangesElementType",{Insert:1,Delete:2,FormatChange:3,JustifyFormatChange:4,Comment:5});
})(Telerik.Web.UI.Editor,$telerik.$);
Type.registerNamespace("$T.Editor");
(function(d,a,c,b){c.TrackChangesUtils={wrapElementInTrackChangeInsert:function(g,e,h,f){this._wrapElementInTrackChangeElement(b.TagInsert,g,b.CssClassInsert,e,h,f);
},wrapElementInTrackChangeDelete:function(g,e,h,f){this._wrapElementInTrackChangeElement(b.TagDelete,g,b.CssClassDelete,e,h,f);
},_wrapElementInTrackChangeElement:function(s,m,h,g,t,l){if(s=="del"&&m.tagName=="HR"){return true;
}var r="";
if(s=="del"){r="Deleted by ";
}else{if(s=="ins"){r="Inserted by ";
}else{if(s=="font"){r="Formatted by ";
}}}if(!t){t=new Date().getTime();
}if(m.tagName=="BODY"){for(var n=0;
n<m.childNodes.length;
n++){var f=m.childNodes[n];
var p=f.ownerDocument.createElement(s);
p.className=h;
p.setAttribute(b.Attribute.Cite,g);
p.setAttribute(b.Attribute.Timestamp,t);
p.setAttribute(b.Attribute.Title,r+g+" on "+new Date(t).toLocaleString());
if(s=="del"){p.setAttribute("name",l.get_deletedElemName());
}m.insertBefore(p,f);
p.appendChild(f);
c.TrackChangesUtils.getDomRange(l).selectNodeContents(p);
}}else{try{var o=l.get_document().createElement(s);
o.className=h;
o.setAttribute(b.Attribute.Cite,g);
o.setAttribute(b.Attribute.Timestamp,t);
o.setAttribute(b.Attribute.Title,r+g+" on "+new Date(t).toLocaleString());
if(s=="del"){o.setAttribute("name",l.get_deletedElemName());
if(m.nodeName!="#text"&&m.contentEditable.match(/(true|false)/i)){var q=m;
while(q.nodeName!="BODY"){if(q.nodeName=="A"&&q.contentEditable.match(/(true|false)/i)){break;
}q=q.parentElement;
}m=q;
}}if(m.parentNode){m.parentNode.insertBefore(o,m);
o.appendChild(m);
var j=c.TrackChangesUtils.getDomRange(l);
j.selectNodeContents(o);
j.select();
}else{m.outerHTML=$telerik.getOuterHtml(o);
l.selectElement(m);
}l.getSelection().getRange().collapse(false);
}catch(k){}}},wrapRangeInTrackChangeInsert:function(f,e,g){if(!g){g=new Date().getTime();
}f.select();
f.pasteHTML("<"+b.TagInsert+" class='"+b.CssClassInsert+"' "+b.Attribute.Cite+"='"+e+"' "+b.Attribute.Timestamp+"='"+g+"' "+b.Attribute.Title+"='Inserted by "+e+" on "+new Date(g).toLocaleString()+"'>"+(f.htmlText.replace(/^\s+/ig,"&nbsp;"))+"</"+b.Taginsert+">");
},wrapRangeInTrackChangeDelete:function(j,f,l,g){j=c.DomRange.toDomRange(j);
if(!l){l=new Date().getTime();
}j.select();
var k=j.cloneRange();
k.moveEnd("character",-k.getText().length);
var i=k.getParentElement();
if(g.checkIfRangeIsInEndOfElement(i,k)&&i.tagName.toLowerCase()!="td"){var h=j.getHtml().replace(/^\s+/ig,"&nbsp;");
var e=j.getText().length;
j.pasteHTML("");
i.insertAdjacentHTML("afterEnd","<"+b.TagDelete+" name='"+g.get_deletedElemName()+"' class='"+b.CssClassDelete+"' "+b.Attribute.Cite+"='"+f+"' "+b.Attribute.Timestamp+"='"+l+"' "+b.Attribute.Title+"='Deleted by "+f+" on "+new Date(l).toLocaleString()+"'>"+h+"</"+b.TagDelete+">");
k.moveEnd("character",e);
k.moveStart("character",e);
k.select();
g._reselectRange=true;
}else{g.addToStack(c.TrackChangesCommandStrings.TrackChange);
j.pasteHTML("<"+b.TagDelete+" name='"+g.get_deletedElemName()+"' class='"+b.CssClassDelete+"' "+b.Attribute.Cite+"='"+f+"' "+b.Attribute.Timestamp+"='"+l+"' "+b.Attribute.Title+"='Deleted by "+f+" on "+new Date(l).toLocaleString()+"'>"+(j.getHtml().replace(/^\s+/ig,"&nbsp;"))+"</"+b.TagDelete+">");
}},wrapRangeInTrackChangeDeleteTextOnly:function(h,e,i,f){h=c.DomRange.toDomRange(h);
if(!i){i=new Date().getTime();
}h.select();
f.addToStack(c.TrackChangesCommandStrings.TrackChange);
h.pasteHTML("<"+b.TagDelete+" id='virtxNewDelEl' class='"+b.CssClassDelete+"' "+b.Attribute.Cite+"='"+e+"' "+b.Attribute.Timestamp+"='"+i+"' "+b.Attribute.Title+"='Deleted by "+e+" on "+new Date(i).toLocaleString()+"'>"+(h.getText().replace(/^\s+/ig,"&nbsp;"))+"</"+b.TagDelete+">");
var g=f.get_document().getElementById("virtxNewDelEl");
if($telerik.isSafari){f.selectElement(g);
}g.removeAttribute("id");
f.getSelection().collapse(false);
},wrapCutElement:function(i,f,k,h,j){if(!k){k=new Date().getTime();
}if(j==null){j=h.getSelection().getRange();
}else{j.select();
}try{h.addToStack(c.TrackChangesCommandStrings.TrackChange);
j.pasteHTML("<"+b.TagDelete+" name ='"+k+"' class='"+b.CssClassDelete+"' "+b.Attribute.Cite+"='"+f+"' timestamp='"+k+"' "+b.Attribute.Title+"='Deleted by "+f+" on "+new Date(k).toLocaleString()+"'>"+i+"</"+b.TagDelete+">");
}catch(g){}},wrapTextInTrackChangeInsert:function(h,f,i,e,g){return this._wrapTextInTrackChange(b.TagInsert,b.CssClassInsert,h,f,i,e,g);
},wrapTextInTrackChangeDelete:function(g,f,h,e){return this._wrapTextInTrackChange(b.TagDelete,b.CssClassDelete,g,f,h,e);
},_wrapTextInTrackChange:function(o,h,p,g,q,e,j){if(!p){return null;
}var m="";
if(o=="del"){m="Deleted by ";
}else{if(o=="ins"){m="Inserted by ";
}else{if(o=="font"){m="Formatted by ";
}}}if(!q){q=new Date().getTime();
}var f="";
if(e){for(var k in e){f+=" "+k+"='"+e[k]+"'";
}}var r="";
if(typeof(j)!="undefined"&&j!=null&&j!=false){if(o=="ins"){var l='<a href="'+j.href+'" >';
var i="</a>";
r=l+"<"+o+" class='"+h+"' "+b.Attribute.Cite+"='"+g+"' "+b.Attribute.Timestamp+"='"+q+"' "+b.Attribute.Title+"='"+m+g+" on "+new Date(q).toLocaleString()+"'"+f+">"+(p.replace(/^\s+/ig,"&nbsp;"))+"</"+o+">"+i;
}}else{r="<"+o+" class='"+h+"' "+b.Attribute.Cite+"='"+g+"' "+b.Attribute.Timestamp+"='"+q+"' "+b.Attribute.Title+"='"+m+g+" on "+new Date(q).toLocaleString()+"'"+f+">"+(p.replace(/^\s+/ig,"&nbsp;"))+"</"+o+">";
}return r;
},wrapElementInTrackChanageComment:function(g,f,e){var i=g.ownerDocument.createElement(b.TagComment);
i.className=f;
i.setAttribute("id",editor.get_commentID());
i.setAttribute(b.Attribute.Comment," ");
i.setAttribute(b.Attribute.Author,e);
i.setAttribute(b.Attribute.Title," ");
i.setAttribute(b.Attribute.Timestamp,new Date().getTime());
if(g.nodeName=="TABLE"){i.innerHTML=$telerik.getOuterHtml(g);
var h=$telerik.getOuterHtml(i);
editor.selectElement(g);
editor.executeBrowserCommand("Delete");
var j=editor.getSelection().getRange();
j.pasteHTML(h);
j.move("character",-1);
j.select();
}else{g.parentElement.replaceChild(i,g);
i.appendChild(g);
editor.selectElement(g);
}},removeInsertTrackChangeChildren:function(e){a(b.TagInsert,e).remove();
},removeNodeTracking:function(f){if(f.nodeType!=1){return;
}var e=f.getAttribute("alignOrig");
if(e){if(e=="none"){f.removeAttribute("align");
f.style.textAlign="";
}else{f.setAttribute("align",e);
f.style.textAlign=e;
}}this.clearTrackingAttributes(f);
},clearTrackingAttributes:function(e){if(e.nodeType!=1){return;
}e.removeAttribute(b.Attribute.Author);
e.removeAttribute(b.Attribute.BrowserCommand);
e.removeAttribute(b.Attribute.Timestamp);
e.className=e.getAttribute("originalCssClass");
if(!e.className){e.removeAttribute("class");
}e.removeAttribute(b.Attribute.Title);
e.removeAttribute("alignOrig");
},containsChangesFromOthers:function(g,f){var e=g.match(this._regexTrackChangesTagMatch);
return(null!=e&&e[1]!=f);
},findTrackChangesParentElementCommentExcluded:function(i){if(!i){return null;
}var j={HtmlElement:null,Type:null,User:"",isInDeleteTrackChangeElement:function(n){return c.TrackChangesUtils._isInTrackChangeElement(this,n,c.TrackChangesElementType.Delete);
},isInInsertTrackChangeElement:function(n){return c.TrackChangesUtils._isInTrackChangeElement(this,n,c.TrackChangesElementType.Insert);
}};
var k=i.tagName.toLowerCase();
if(k=="td"||k=="a"){var m=editor.getSelection();
if(!m.isControl()){var l=m.getRange().parentElement();
while(l&&null!=l.tagName&&l.tagName!=k){var g=new RegExp("<s*font|span.*?>","ig").exec($telerik.getOuterHtml(l));
if(g&&l.className.match(b.CommentsRegex)){i=l;
k=i.tagName.toLowerCase();
break;
}l=l.parentNode;
}}}var f="";
var h=i;
while(h&&k!="body"){if(k==b.TagInsert){f=h.getAttributeNode(b.Attribute.Cite);
j.User=(null==f)?"":f.value;
j.HtmlElement=h;
j.Type=c.TrackChangesElementType.Insert;
return j;
}if(k==b.TagDelete){f=h.getAttributeNode(b.Attribute.Cite);
j.User=(null==f)?"":f.value;
j.HtmlElement=h;
j.Type=c.TrackChangesElementType.Delete;
return j;
}if(h.className&&(h.className.indexOf(b.CssClassNamePrefixFormat)==0)){f=h.getAttributeNode(b.Attribute.Author);
var e=h.getAttributeNode(b.Attribute.BrowserCommand);
j.User=(null==f)?"":f.value;
j.HtmlElement=h;
j.BrowserCommand=(null==e)?"":e.value;
j.Type=c.TrackChangesElementType.FormatChange;
return j;
}h=h.parentNode;
k=h.tagName.toLowerCase();
}return null;
},findTrackChangesParentElementForReject:function(i){if(!i){return null;
}var j={HtmlElement:null,Type:null,User:"",isInDeleteTrackChangeElement:function(n){return c.TrackChangesUtils._isInTrackChangeElement(this,n,c.TrackChangesElementType.Delete);
},isInInsertTrackChangeElement:function(n){return c.TrackChangesUtils._isInTrackChangeElement(this,n,c.TrackChangesElementType.Insert);
}};
var k=i.nodeName.toLowerCase();
if(k=="td"||k=="a"){var m=editor.getSelection();
if(!m.isControl()){var l=m.getRange().parentElement();
while(l&&null!=l.tagName&&l.tagName!=k){var g=new RegExp("<s*font|span.*?>","ig").exec($telerik.getOuterHtml(l));
if(g&&l.className.match(b.CommentsRegex)){i=l;
k=i.tagName.toLowerCase();
break;
}l=l.parentNode;
}}}var f="";
var h=i;
while(h&&k!="body"){if(k==b.TagInsert){f=h.getAttributeNode(b.Attribute.Cite);
j.User=(null==f)?"":f.value;
j.HtmlElement=h;
j.Type=c.TrackChangesElementType.Insert;
return j;
}if(k==b.TagDelete){f=h.getAttributeNode(b.Attribute.Cite);
j.User=(null==f)?"":f.value;
j.HtmlElement=h;
j.Type=c.TrackChangesElementType.Delete;
return j;
}if(h.className&&(h.className.indexOf(b.CssClassNamePrefixFormat)==0)){f=h.getAttributeNode(b.Attribute.Author);
var e=h.getAttributeNode(b.Attribute.BrowserCommand);
j.User=(null==f)?"":f.value;
j.HtmlElement=h;
j.BrowserCommand=(null==e)?"":e.value;
j.Type=c.TrackChangesElementType.FormatChange;
return j;
}h=h.parentNode;
k=h.tagName.toLowerCase();
}return null;
},findTrackChangesParentElementFormatExcluded:function(i,h){if(!i){return null;
}var j={HtmlElement:null,Type:null,User:"",isInDeleteTrackChangeElement:function(n){return c.TrackChangesUtils._isInTrackChangeElement(this,n,c.TrackChangesElementType.Delete);
},isInInsertTrackChangeElement:function(n){return c.TrackChangesUtils._isInTrackChangeElement(this,n,c.TrackChangesElementType.Insert);
}};
var k=i.tagName.toLowerCase();
if(k=="td"||k=="a"){var m=h.getSelection();
if(!m.isControl()){var l=m.getRange().parentElement();
while(l&&null!=l.tagName&&l.tagName!=k){var f=new RegExp("<s*font|span.*?>","ig").exec($telerik.getOuterHtml(l));
if(f&&l.className.match(b.CommentsRegex)){i=l;
k=i.tagName.toLowerCase();
break;
}l=l.parentNode;
}}}var e="";
var g=i;
while(g&&k!="body"){if(k==b.TagInsert){e=g.getAttributeNode(b.Attribute.Cite);
j.User=(null==e)?"":e.value;
j.HtmlElement=g;
j.Type=c.TrackChangesElementType.Insert;
return j;
}if(k==b.TagDelete){e=g.getAttributeNode(b.Attribute.Cite);
j.User=(null==e)?"":e.value;
j.HtmlElement=g;
j.Type=c.TrackChangesElementType.Delete;
return j;
}if((k==b.TagComment)&&(g.className.indexOf(b.CssClassNamePrefixComment)==0)){e=g.getAttributeNode(b.Attribute.Author);
j.User=(null==e)?"":e.value;
j.HtmlElement=g;
j.Type=c.TrackChangesElementType.Comment;
return j;
}g=g.parentNode;
k=g.tagName.toLowerCase();
}return null;
},findTrackChangesParentElement:function(j,i){if(!j||!i){return null;
}var l={HtmlElement:null,Type:null,User:"",isInDeleteTrackChangeElement:function(q){return c.TrackChangesUtils._isInTrackChangeElement(this,q,c.TrackChangesElementType.Delete);
},isInInsertTrackChangeElement:function(q){return c.TrackChangesUtils._isInTrackChangeElement(this,q,c.TrackChangesElementType.Insert);
}};
var m=(j.tagName)?j.tagName.toLowerCase():"";
if(m=="td"||m=="a"){var o=i.getSelection();
if(!o.isControl()){var p=new c.DomRange(o.getRange());
var n=p.getParentElement();
while(n&&null!=n.tagName&&n.tagName!=m){var g=new RegExp("<s*font|span.*?>","ig").exec($telerik.getOuterHtml(n));
var k=new RegExp("<s*u|strong|em|sup|sub|strike.*?>","ig").exec($telerik.getOuterHtml(n));
if((g&&n.className.match(b.CommentsRegex))||(k&&n.className.match(/format_/i))){j=n;
m=j.tagName.toLowerCase();
break;
}n=n.parentNode;
}}}var f="";
var h=j;
while(h&&m!="body"){if(m==b.TagInsert){f=h.getAttributeNode(b.Attribute.Cite);
l.User=(null==f)?"":f.value;
l.HtmlElement=h;
l.Type=c.TrackChangesElementType.Insert;
return l;
}if(m==b.TagDelete){f=h.getAttributeNode(b.Attribute.Cite);
l.User=(null==f)?"":f.value;
l.HtmlElement=h;
l.Type=c.TrackChangesElementType.Delete;
return l;
}if((m==b.TagComment)&&(h.className.indexOf(b.CssClassNamePrefixComment)==0)){f=h.getAttributeNode(b.Attribute.Author);
l.User=(null==f)?"":f.value;
l.HtmlElement=h;
l.Type=c.TrackChangesElementType.Comment;
return l;
}if(h.className&&(h.className.indexOf(b.CssClassNamePrefixFormat)==0)){f=h.getAttributeNode(b.Attribute.Author);
var e=h.getAttributeNode(b.Attribute.BrowserCommand);
l.User=(null==f)?"":f.value;
l.HtmlElement=h;
l.BrowserCommand=(null==e)?"":e.value;
l.Type=c.TrackChangesElementType.FormatChange;
return l;
}h=h.parentNode;
m=h.tagName.toLowerCase();
}return null;
},isInDeleteTrackChangeElement:function(f,e){var g=findTrackChangesParentElement(f);
return _isInTrackChangeElement(g,e,c.TrackChangesElementType.Delete);
},isInInsertTrackChangeElement:function(f,e){var g=findTrackChangesParentElement(f);
return _isInTrackChangeElement(g,e,c.TrackChangesElementType.Insert);
},_isInTrackChangeElement:function(g,e,f){if(g==null){return false;
}if(g.Type==f){if(e==null){return true;
}else{if(e==g.User){return true;
}}}return false;
},isTrackChangeElement:function(e){var f=b.CssClassNamePrefixFormat;
var g=e.nodeName.toLowerCase();
return g=="ins"||g=="del"||Sys.UI.DomElement.containsCssClass(e,f);
},markEditorSelection:function(o){if(o.get_html()==""){return{markedElements:[],newElements:[]};
}var n="AZBY";
var l="_cm";
var y=[];
var z=[];
var A=[];
var t="font";
var p=o._contentArea;
var q=o.getSelection();
var F=q.getRange();
var m=new c.DomRange(F);
var h=c.TrackChangesSelection.locateElementInRange(F,"comment");
if(h.fullySelected){var g=q.getParentElement();
var v=g.ownerDocument.createElement("FONT");
v.innerHTML=g.innerHTML;
g.innerHTML=$telerik.getOuterHtml(v);
m.selectNodeContents(g);
q.selectRange(F);
}var E=[];
var C="a";
var H=o.getSelection().getParentElement();
if(!H.getElementsByTagName){H=m.getParentElement();
}var D=H.getElementsByTagName(C);
for(var u=0;
u<D.length;
u++){var I=D[u];
if(I.contentEditable=="true"){E.push(I.innerHTML);
I.innerHTML="";
}}if(q.isControl()){var k=q.getParentElement();
var s=o._document.createElement(t);
s.appendChild(k.cloneNode(true));
k.parentNode.replaceChild(s,k);
return{markedElements:[s],newElements:[s]};
}if(!$telerik.isSafari){x();
}if(!$telerik.isIE){p.ownerDocument.execCommand("UseCSS",false,true);
}p.ownerDocument.execCommand("FontName",false,n);
var B=0;
for(var u=0;
u<D.length;
u++){var I=D[u];
if(I.contentEditable=="true"){I.innerHTML=E[B];
B++;
}}var r=p.getElementsByTagName(t);
for(var u=0;
u<r.length;
u++){var s=r[u];
if(s.getAttribute("face")==n||s.style.fontFamily==n){s.removeAttribute("face");
if(s.style.fontFamily==n){s.style.fontFamily="";
}z.push(s);
var f=s.getElementsByTagName(t);
for(var w=0;
w<f.length;
w++){var e=f[w];
if(e.getAttribute("face")!=n){z.push(e);
}}if(!s.getAttribute(l)){A.push(s);
}}s.removeAttribute(l);
}A=z;
if(!$telerik.isSafari){G();
}if(!$telerik.isIE){p.ownerDocument.execCommand("UseCSS",false,false);
}function x(){var j=o._contentArea.getElementsByTagName(t);
for(var K=0;
K<j.length;
K++){var J=j[K];
if(j[K].face){J.setAttribute("_face",J.face);
y.push(J);
}J.setAttribute(l,1);
}}function G(){for(var K=0;
K<y.length;
K++){var J=y[K].getAttribute("face");
if(!J){var j=y[K].getAttribute("_face");
y[K].removeAttribute("_face");
y[K].setAttribute("face",j);
continue;
}y[K].face=y[K].getAttribute("_face");
y[K].removeAttribute("_face");
}y=[];
}return{markedElements:z,newElements:A};
},enumerateElemetsInRange:function(g){if(!g){return null;
}g=c.DomRange.toDomRange(g);
var h=g.cloneRange();
var f=g.getParentElement();
return e(f);
function e(k){var n=[];
h.selectNodeContents(k);
if(g.inRange(h)){n.push(k);
return n;
}var l=0;
for(;
l<k.childNodes.length;
l++){var j=k.childNodes(l);
if(!j.canHaveHTML){continue;
}var m=e(j);
if(m.length>0){n=n.concat(m);
}}return n;
}},enumerateNodesInRange:function(g){var j=[];
var g=new d.Editor.DomRange(g);
var k=g.getParentElement();
if(k==null){return j;
}if(!k.tagName){k=k.parentNode;
}var h=g.cloneRange();
h.selectNodeContents(k);
if(!c.Utils.isEditorContentArea(k)&&this.intersect(h,g)){j.push(k);
}for(var f=0;
f<k.children.length;
f++){var e=k.children[f];
if(!e.innerHTML){continue;
}h.selectNodeContents(e);
if(this.intersect(h,g)){j.push(e);
}}g.select();
return j;
},enumerateElemetsInSelection:function(g){if(!g){return null;
}range=c.DomRange.toDomRange(range);
var h=range.cloneRange();
var f=range.getParentElement();
return e(f);
function e(k){var n=[];
h.selectNodeContents(k);
if(range.inRange(h)){n.push(k);
return n;
}var l=0;
for(;
l<k.childNodes.length;
l++){var j=k.childNodes(l);
if(!j.canHaveHTML){continue;
}var m=e(j);
if(m.length>0){n=n.concat(m);
}}return n;
}},intersect:function(e,f){return !((e.compareBoundaryPoints(d.Editor.DomRange.START_TO_START,f)==-1&&e.compareBoundaryPoints(d.Editor.DomRange.START_TO_END,f)==-1)||(e.compareBoundaryPoints(d.Editor.DomRange.END_TO_START,f)==1&&e.compareBoundaryPoints(d.Editor.DomRange.END_TO_END,f)==1));
},intersectIERange:function(e,f){e=c.DomRange.toDomRange(e);
f=c.DomRange.toDomRange(f);
return !((e.compareBoundaryPoints("StartToStart",f)==-1&&e.compareBoundaryPoints("EndToStart",f)==-1)||(e.compareBoundaryPoints("StartToEnd",f)==1&&e.compareBoundaryPoints("EndToEnd",f)==1));
},getDomRange:function(e,f){var h=e.getSelection(),g=h.getRange();
if(!g){h.selectElement(e.get_contentArea());
h.collapse();
g=h.getRange();
}return new c.DomRange(g,f||{preventCalculateEdges:true});
}};
})(Telerik.Web.UI,$telerik.$,Telerik.Web.UI.Editor,Telerik.Web.UI.Editor.TrackChangesConstants);
Type.registerNamespace("Telerik.Web.UI.Editor");
(function(d,a,c,b){a.extend(c.DefaultToolAdapter.prototype,{onContextMenu:function(j){if(!this._contextMenusEnabled){return;
}var k=this.get_editor();
if(k.get_mode()!=d.EditModes.Design){return;
}this.createContextMenus();
var l=k.getSelectedElement()?k.getSelectedElement():j.srcElement;
var m=l.tagName;
var f=this._contextMenus[m];
if(m=="TD"){f=null;
}if("TH"==m&&!f){f=this._contextMenus.TD;
}var g="";
if(!f){var n=c.Utils.getElementParentByTag(l,"A");
if(n){var h=k.getSelectedElement();
var p=new RegExp("(</?(sub|sup|em|strike|strong|u|del)[^>]*("+b.Attribute.Author+"|"+b.Attribute.Cite+")=?)","i");
if($telerik.getOuterHtml(h).match(p)){n=null;
}}if(!n){n=c.Utils.getElementParentByTag(l,"TD");
}if(!n){n=c.Utils.getElementParentByTag(l,"TABLE");
}if(n){g=n.tagName;
l=n;
}else{g="*";
}f=this._contextMenus[g];
}if(f&&m=="IMG"&&l&&"true"==l.getAttribute("isflash")){f=null;
}var k=this.get_editor();
var o=c.TrackChangesUtils.findTrackChangesParentElement(l,k);
if(o){if(o.Type==c.TrackChangesElementType.Comment){f=this.createContextMenuWithTrackChangeCommentItems(g);
}else{f=this.createContextMenuWithTrackChangeItems(g);
}}else{if(m!="TABLE"&&m!="TH"&&m!="TR"&&m!="IMG"&&m!="A"){f=this.createContextMenuWithTrackChangeDefaultItems(g);
}}if(f){f.set_eventObject(j);
f.show();
}return $telerik.cancelRawEvent(j);
},createContextMenuWithTrackChangeDefaultItems:function(e){return this._createContextMenuWithTrackChangeItems(e,"TrackChangeDefault");
},createContextMenuWithTrackChangeItems:function(e){return this._createContextMenuWithTrackChangeItems(e,"TrackChangeFormat");
},createContextMenuWithTrackChangeCommentItems:function(e){return this._createContextMenuWithTrackChangeItems(e,"TrackChangeComment");
},_createContextMenuWithTrackChangeItems:function(h,n){var l=h+"::"+n;
if(this._contextMenus[l]){return this._contextMenus[l];
}var j=this.get_editor();
var f=j.get_contextMenusJSON();
var e=null;
for(i=0;
i<f.length;
i++){if(f[i].tagName==n){e=f[i];
break;
}}if(!e){return null;
}e.sizetofit=true;
e.parentElement=j.get_contentAreaElement();
e.skin=j.get_skin();
var k={valueSelected:this._onDropDownValueSelectedDelegate,show:this._onDropDownBeforeShowDelegate,hide:this._onDropDownHideDelegate};
var m=$create(d.EditorContextMenu,e,k,null,document.createElement("SPAN"));
if(h!="*"||$telerik.isIE){var g=this._contextMenus[h];
if(g){m._tools=m._tools.concat(g._tools);
}else{return this._contextMenus[n];
}}this._contextMenus[l]=m;
return m;
}});
})(Telerik.Web.UI,$telerik.$,Telerik.Web.UI.Editor,Telerik.Web.UI.Editor.TrackChangesConstants);
Type.registerNamespace("Telerik.Web.UI");
Type.registerNamespace("Telerik.Web.UI.Editor");
(function(b,a){b.Editor.Dialogs=(function(){var s=-75;
var j=0;
var q=true;
var o=0.5;
var n="#FFF";
var h=false;
var l="&nbsp;OK&nbsp;";
var e="&nbsp;Cancel&nbsp;";
var g=null;
var c=$telerik.$;
var d=function(u,w,v,t){if(w==null){w="Alert";
}r(w,u,null,"alert",v,function(x){if(t){t(x);
}});
};
var f=function(u,w,v,t){if(w==null){w="Confirm";
}r(w,u,null,"confirm",v,function(x){if(t){t(x);
}});
};
var r=function(H,w,J,I,G,t){i();
m("show");
var z=c('<div class="rePopupContainer'+(G?" "+G:"")+'">');
var E=c('<h1 class="rePopupTitle"></h1>');
var A=c('<div class="rePopupContent">');
var B=c('<div class="rePopupMessage"></div>');
c("body").append(z);
z.append(E).append(A);
A.append(B);
if(g){z.addClass(g);
}var F=$telerik.isIE6?"absolute":"fixed";
z.css({position:F,zIndex:99999,padding:0,margin:0});
E.text(H);
A.addClass(I);
B.text(w);
B.html(B.text().replace(/\n/g,"<br />"));
z.css({minWidth:z.outerWidth(),maxWidth:z.outerWidth()});
p();
k(true);
if(I=="alert"||I=="confirm"){var x=c('<div class="rePopupButtonContainer"></div>');
var C=c('<input type="button" value="'+l+'" class="rePopupButton ok" />');
B.after(x);
x.append(C);
var u=C;
if(I=="confirm"){var y=c('<input type="button" value="'+e+'" class="rePopupButton cancel" />');
x.append(y);
u=u.add(y);
}var D=C.val();
u.click(function(K){i();
if(t){t(K.target.value==D);
}}).keypress(function(K){if(K.keyCode==13||K.keyCode==27){c(K.target).trigger("click");
}});
}if(h){try{z.draggable({handle:E,revert:true,containment:"window"});
E.css({cursor:"move"});
}catch(v){}}};
var i=function(){var u=c(".rePopupContainer");
try{u.remove();
}catch(t){}m("hide");
k(false);
};
var m=function(v){var u=c(".rePopupOverlay");
switch(v){case"show":m("hide");
u=c('<div class="rePopupOverlay"></div>');
c("BODY").append(u.css({position:"absolute",zIndex:99998,top:"0px",left:"0px",width:"100%",height:c(document).height(),background:n,opacity:o}));
break;
case"hide":try{u.remove();
}catch(t){}break;
}};
var p=function(){var u=c(".rePopupContainer");
var v=c(".rePopupOverlay");
var w=((c(window).height()/2)-(u.outerHeight()/2))+s;
var t=((c(window).width()/2)-(u.outerWidth()/2))+j;
if(w<0){w=0;
}if(t<0){t=0;
}if($telerik.isIE6){w=w+c(window).scrollTop();
}u.css({top:w+"px",left:t+"px"});
v.height(c(document).height());
};
var k=function(t){if(q){switch(t){case true:c(window).bind("resize",p);
break;
case false:c(window).unbind("resize",p);
break;
}}};
return{showAlert:function(u,w,v,t){d(u,w,v,t);
},showConfirm:function(u,w,v,t){f(u,w,v,t);
},showOverlay:function(t,u){if(t){n=t;
}if(u){o=u;
}m("show");
},hideOverlay:function(){m("hide");
}};
})();
})(Telerik.Web.UI,$telerik.$);
Type.registerNamespace("Telerik.Web.UI");
Type.registerNamespace("Telerik.Web.UI.Editor");
(function(b,a){b.EditorDropDown.prototype.__original_scrollIntoView=b.EditorDropDown.prototype._scrollIntoView;
a.extend(b.EditorDropDown.prototype,{_scrollIntoView:function(d,g){if(!d||!d.parentNode){return;
}var i=null;
var h=0;
var f=d.parentNode;
while(f!=null){if(f.tagName=="BODY"){var c=f.ownerDocument;
if(!$telerik.isIE&&c.defaultView&&c.defaultView.frameElement){h=c.defaultView.frameElement.offsetHeight;
}i=f;
break;
}var e=$telerik.getCurrentStyle(f,"overflowY");
if(e=="scroll"||e=="auto"){i=f;
break;
}f=f.parentNode;
}if(!i){return;
}if(!h){h=i.offsetHeight;
}if(h<d.offsetTop+d.offsetHeight){i.scrollTop=(d.offsetTop+d.offsetHeight)-h;
}else{if(d.offsetTop<i.scrollTop){i.scrollTop=d.offsetTop;
}}}});
})(Telerik.Web.UI,$telerik.$);
Type.registerNamespace("Telerik.Web.UI");
Type.registerNamespace("Telerik.Web.UI.Editor");
(function(e,a,d,b){d.isControlOnDrag=false;
d.dragIsCancelled=false;
d.placeHolderID=null;
d.isPlaceHolder=false;
d.hasBeenDropped=false;
d.isHyperLink=false;
a.registerControlProperties(e.RadEditor,{fromTableProperties:false,enableTrackChangesOverride:false,isAuthor:false,author:"",reviewer:"",userCssId:"",tcInfoContainer:null,rangeStorage:[,],enableCarriageReturn:false,enableInsertParagraphShortCut:false,enableShiftEnterShortCut:false,enableBoldShortCut:false,enableItalicShortCut:false,enableUnderlineShortCut:false,tempElement:document.createElement("div"),cancelBackspaceEventCaretPosition:0,cachedRange:null,elementToMove:null,reselectRange:false,iRange:null,origCutRange:null,contextMenuItems:null,commentID:"radTempCommentID",hasWorkFlowRole:false,canAcceptTrackChanges:false,canAcceptTrackChange:false,canRejectTrackChange:false,overrideWorkFlowAction:false,keyDownEvent:null,paragraphInserted:null,deletedElemName:"",origClipboardDataAsHtml:"",modifiedClipboardDataWithPlaceHolder:"",lockFormatting:true,copyCommandHit:false,clipboardData:{contentFromEditor:false,contentHTML:"",fromSelectionType:""},cutElement:{htmlText:null,selectionType:null,element:null}});
e.RadEditor.prototype.__original_initialize=e.RadEditor.prototype.initialize;
e.RadEditor.prototype.__original_pasteHtml=e.RadEditor.prototype.pasteHtml;
e.RadEditor.prototype.__original__initEvents=e.RadEditor.prototype._initEvents;
e.RadEditor.prototype.__original_onResizeEnd=e.RadEditor.prototype._onResizeEnd;
e.RadEditor.prototype.__original_getToolState=e.RadEditor.prototype.getToolState;
a.extend(e.RadEditor.prototype,{_regexTrackChangesTagMatch:new RegExp("<(?:ins|del|font|span|strong|em|sup|sub)[^>]*(?:"+b.Attribute.Cite+"|"+b.Attribute.Author+")=['\"]{0,1}([^>'\"]*)['\"]{0,1}[^>]*>([\\s\\S]*?)</(?:ins|del|font|span|strong|em|sup|sub)>","i"),initialize:function(){var h=this;
j();
this.__original_initialize();
i();
function j(){}function f(){try{if(!h._toolJSON){return;
}for(var m=0;
m<h._toolJSON.length;
m++){if(h._toolJSON[m].tag&&h._toolJSON[m].tag=="DropdownToolbar"){var q=h._toolJSON[m];
for(var n=0;
n<q.tools.length;
n++){if(q.tools[n].name=="InsertTable"){var p=[];
for(var o=0;
o<q.tools[n].tools.length;
o++){if(q.tools[n].tools[o].name!="TableWizard"&&q.tools[n].tools[o].name!="SetCellProperties"&&q.tools[n].tools[o].name!="InsertRowAbove"&&q.tools[n].tools[o].name!="InsertRowBelow"&&q.tools[n].tools[o].name!="InsertColumnLeft"&&q.tools[n].tools[o].name!="InsertColumnRight"&&q.tools[n].tools[o].name!="DeleteRow"&&q.tools[n].tools[o].name!="DeleteColumn"&&q.tools[n].tools[o].name!="DeleteCell"&&q.tools[n].tools[o].name!="MergeColumns"&&q.tools[n].tools[o].name!="MergeRows"&&q.tools[n].tools[o].name!="SplitCell"&&q.tools[n].tools[o].name!="SetTableProperties"){p.push(q.tools[n].tools[o]);
}}q.tools[n].tools=p;
break;
}}break;
}}}catch(l){}}function i(){k();
g();
}function k(){var l=h.get_filtersManager();
var n=l.getFilterByName("FixUlBoldItalic");
if(n){l.remove(n);
}var m=l.getFilterByName("FixEnclosingP");
if(m){l.remove(m);
}}function g(){d.UpdateCommandsArray.AcceptAllTrackChanges=new d.TrackChangesCommands.AcceptTrackChanges("Accept All Track Changes",h,null);
d.UpdateCommandsArray.AcceptTrackChange=d.UpdateCommandsArray.AcceptTrackChanges=new d.TrackChangesCommands.AcceptTrackChanges(null,h,null);
d.UpdateCommandsArray.RejectAllTrackChanges=new d.TrackChangesCommands.RejectTrackChanges("Reject All Track Changes",h,null);
d.UpdateCommandsArray.RejectTrackChange=d.UpdateCommandsArray.RejectTrackChanges=new d.TrackChangesCommands.RejectTrackChanges(null,h,null);
d.UpdateCommandsArray.RemoveTrackChanges=new d.TrackChangesCommands.RemoveTrackChanges(null,h,null);
d.UpdateCommandsArray.RemoveAllComments=new d.TrackChangesCommands.RemoveTrackChanges("Remove All Comments",h,null);
d.UpdateCommandsArray.RemoveComment=new d.TrackChangesCommands.RemoveTrackChanges(null,h,null);
d.UpdateCommandsArray.AddComment=new d.TrackChangesCommands.AddComment(null,h,null);
d.UpdateCommandsArray.EnableTrackChanges=new d.TrackChangesCommands.EnableTrackChanges(null,h,null);
d.UpdateCommandsArray.EnableTrackChangesOverride=new d.TrackChangesCommands.EnableTrackChangesOverride(null,h,null);
}},executeCommand:function(g,h,f){if(!g.get_window()){g.set_window(this.get_contentWindow());
}if(false!=h&&!this.isOpera){this.setFocus();
}if(g.get_title()!="Typing"&&this.get_enableTrackChanges()){if(this.getSelection().getBrowserSelection()!=null&&!this._canExecuteTrackChangeCommand()){if(g.get_title()=="Typing..."){$telerik.cancelRawEvent(g._window.event);
}alert("Cannot alter text modified by other reviewers.");
return;
}}this._commandsManager.execute(g,f);
},executeBrowserCommand:function(i,f,l,j){var k=this._localization[i];
var g=new d.BrowserCommand(k,this._contentWindow,i,l);
if(this.get_enableTrackChanges()){var h=this.getSelection().getRange();
if(h&&this._containsChangesFromOthers(h,this._reviewer)){alert("Cannot alter text modified by other reviewers.");
return;
}g._editor=this;
}this.executeCommand(g);
this.setActive();
this.setFocus();
if(true==j){this.raiseEvent("selectionChange",Sys.EventArgs.Empty);
}},executeFormatTrackChangesCommand:function(g){if(!this._canEditSelection()){alert(this.get_localization()["caneditselection"]);
return true;
}var f;
if(g.indexOf("Justify")==0){f=new d.TrackChangesJustifyFormatCommand(g,this);
}else{if(g.indexOf("Indent")==0||g.indexOf("Outdent")==0){f=new d.TrackChangesIndentOutdentFormatCommand(g,this);
}else{f=new d.TrackChangesFormatCommand(g,this);
}}this.executeCommand(f);
this.raiseEvent("selectionChange",Sys.EventArgs.Empty);
return true;
},get_htmlAcceptChanges:function(h,j){var i=this.get_html();
var f=this.get_filtersManager();
d.TrackChanges.setEditor(this);
d.TrackChanges.acceptAllChangesSilently();
if(j==true){f.add(new d.StripCommentsFilter());
}var g=this.get_html(h==true);
if(j==true){f.removeFilterByName("StripCommentsFilter");
}e.Editor.Utils.setElementInnerHtml(this.get_contentArea(),i);
return g;
},get_htmlRejectChanges:function(h,j){var i=this.get_html();
var f=this.get_filtersManager();
d.TrackChanges.setEditor(this);
d.TrackChanges.rejectAllChangesSilently();
if(j==true){f.add(new d.StripCommentsFilter());
}var g=this.get_html(h==true);
if(j==true){f.removeFilterByName("StripCommentsFilter");
}e.Editor.Utils.setElementInnerHtml(this.get_contentArea(),i);
return g;
},get_htmlStripComments:function(){var h=this.get_html();
var f=this.get_filtersManager();
f.add(new d.StripCommentsFilter());
var g=this.get_html(true);
f.removeFilterByName("StripCommentsFilter");
e.Editor.Utils.setElementInnerHtml(this.get_contentArea(),h);
return g;
},pasteHtml:function(l,j,h,g,f){function N(){var S=false;
var R=false;
var T=document.createElement("DIV");
T.innerHTML=l;
if(T.children.length>0){if(T.children.length==1&&T.children[0].tagName=="TABLE"){R=true;
}if(T.children.length==2&&T.children[0].tagName=="TABLE"&&T.children[1].tagName=="STYLE"){R=true;
}}if(R){S=d.TrackChangesUtils.wrapTextInTrackChangeInsert(l,E._reviewer);
}return S;
}function A(){var R=E._document.getElementById("virtxNewInsertEl");
if(R){R.removeAttribute("id");
E.selectElement(R);
E.getSelection().collapse();
R.innerHTML="";
}}function M(S){var R=S;
R=R.replace(/<\s*u.*?>/gi,"");
R=R.replace(/<\s*\/\s*u\s*.*?>/gi,"");
R=R.replace(/<\s*font.*?>/gi,"");
R=R.replace(/<\s*\/\s*font\s*.*?>/gi,"");
return R;
}function i(S){var R=false;
if(S.match(/<\/?(a).*\n*href=.*[^>]*\/?>/i)){R=q(S);
}return R;
}function q(T){var S=false;
var U=document.createElement("DIV");
U.innerHTML=T;
if(U.childNodes.length==1&&U.children.length==1){var R=U.childNodes[0];
if(R.nodeName=="A"){S={text:"",href:"",className:"",target:"",title:""};
S.className=R.className;
S.href=R.href;
S.target=R.target;
S.text=R.innerHTML;
S.title=R.title;
}}return S;
}function I(){var R=E.getSelectedElement();
if(R.nodeName=="INS"){R=R.parentElement;
if(R.nodeName=="A"){if(typeof(R.innerText)!="undefined"){R.innerText=R.innerText==" "?"":R.innerText;
}else{R.textContent=R.textContent==" "?"":R.textContent;
}}}}try{if(e.EditModes.Design==this.get_mode()){this.setFocus();
}else{return this.__original_pasteHtml(l,j,h,g,true);
}var E=this;
if(E._cachedRange){E._cachedRange.select();
E._cachedRange=null;
}var K=E.getSelectedElement();
var L=E.getSelection();
if(K.contentEditable!=undefined&&L.isControl()&&(K.contentEditable=="false"||K.contentEditable=="true")){return true;
}var o=new d.DomRange(L.getRange());
var G=d.TrackChangesUtils.findTrackChangesParentElement(K,E);
l=d.TrackChangesSelection.stripPlaceHolders(l,false,"caption");
if(!E.get_enableTrackChanges()||E.get_enableTrackChangesOverride()||(L.isControl())){h=undefined;
if(!E.get_enableTrackChanges()||E.get_enableTrackChangesOverride()){var t=d.TrackChangesSelection.locateElementInRange(o.range,"ins");
var n=d.TrackChangesSelection.locateElementInRange(o.range,"del");
if(t.inRange||n.inRange){return false;
}}if(G){if(N()&&L.getParentElement().tagName=="TABLE"){return this.__original_pasteHtml(N(),j,h,g,true);
return true;
}if(L.isControl()&&G.isInInsertTrackChangeElement()){E.executeBrowserCommand("Delete");
E.pasteHtml(l);
return false;
}G.HtmlElement.insertAdjacentHTML("afterEnd","<font id='virtxNewInsertEl'>&nbsp;</font>");
A();
return this.__original_pasteHtml(l,j,h,g,true);
return true;
}if(!E.get_fromTableProperties()){l=d.TrackChangesSelection.stripTrackChanges(l);
}E.set_fromTableProperties(false);
var w=l.match(/<\s*a(.|\n)*?>/i);
var x=l.match(/(<\/?(span|font)[^>]*(name)\s*=\s*?(\'|\")+(_wp)+.*)/i);
var u=((w&&w.index==0)&&x);
var B=false;
if(E.get_enableTrackChanges()&&!E.get_enableTrackChangesOverride()){d.TrackChangesUtils.wrapElementInTrackChangeDelete(L.getParentElement(),E._reviewer);
l=d.TrackChangesUtils.wrapTextInTrackChangeInsert(l,E._reviewer,null,false,false);
B=true;
a("<font id='virtxNewInsertEl'>&nbsp;</font>").insertAfter(K.parentElement);
A();
}if(!E._canEditSelection()){$telerik.cancelRawEvent(p);
alert(editor.get_localization()["caneditselection"]);
return true;
}return this.__original_pasteHtml(l,j,h,g,true);
return true;
}if(L.isControl()){$telerik.cancelRawEvent(p);
return true;
}if(!E.get_fromTableProperties()){l=d.TrackChangesSelection.stripTrackChanges(l);
}E.set_fromTableProperties(false);
if(E.get_enableTrackChanges()||!E.get_enableTrackChangesOverride()){if(G){var F=G.HtmlElement;
while(F&&F.tagName.toLowerCase()!="body"){if(F.tagName=="INS"){var s=F.innerHTML;
try{var z="<(p)[^>]*/?>&nbsp;</(?:\1)>";
var y="<(p)[^>]*/?></(?:\1)>";
if((s.match(y))||(s.match(z))){s=s.replace(/<(p)[^>]*\/?><\/(?:\1)>/ig,"");
s=s.replace(/<(p)[^>]*\/?>&nbsp;<\/(?:\1)>/ig,"<BR/>");
G.HtmlElement.innerHTML=s;
break;
}}catch(p){}}F=F.parentElement;
}try{var O=K;
while(O&&O.tagName.toLowerCase()!="body"){if(O.tagName=="INS"){if(d.Utils.getTextContent(O)==""){if(O.innerHTML!=""){if(O.firstChild.nodeName=="IMG"||O.firstChild.nodeName=="TABLE"){O=O.parentElement;
continue;
}}K=O;
K.innerHTML="";
break;
}}O=O.parentElement;
}}catch(p){}}}if((E.get_enableTrackChangesOverride())||(G&&G.isInInsertTrackChangeElement(E._reviewer))){return this.__original_pasteHtml(l,j,h,g,true);
}if(!E._canEditSelection()){$telerik.cancelRawEvent(p);
alert(editor.get_localization()["caneditselection"]);
return true;
}var v=i(l);
if(v){l=v.text;
}if(o&&o.getHtml()!=""){var k=d.TrackChangesSelection.locateElementInRange(o.range,"comment");
if(!E._deleteSelection(true)){$telerik.cancelRawEvent(p);
return;
}o=d.TrackChangesUtils.getDomRange(this);
if(k.partialOverlapped){var H=E.getSelection().getRange().parentElement().previousSibling;
if(H&&H.childNodes.length>1){var D=H.childNodes.length;
var J=H.childNodes[D-1];
if(J.nodeName=="DEL"){E.selectElement(J);
var m=o.cloneRange();
m.collapse(false);
m.select();
if(m.getParentElement().nodeName=="DEL"){o=m;
}}}}var P=d.TrackChangesUtils.wrapTextInTrackChangeInsert(l,E._reviewer,null,false,v);
trackChange=d.TrackChangesUtils.findTrackChangesParentElement(o.getParentElement(),E);
if(trackChange&&trackChange.HtmlElement.tagName.toLowerCase()=="del"){a(P).insertAfter(trackChange.HtmlElement);
}else{if(o.text!=""){a(P).insertAfter(o.getParentElement());
}else{o.pasteHTML(P);
}}return;
}if(G){var Q=G.HtmlElement;
var P=d.TrackChangesUtils.wrapTextInTrackChangeInsert(l,E._reviewer,null,false,v);
if(Q&&Q.tagName.toLowerCase()=="del"){a(P).insertAfter(Q);
}else{o.pasteHTML(P);
}return;
}try{var r=document.createElement(l);
var C=l;
if(r.tagName!="HR"){C=d.TrackChangesUtils.wrapTextInTrackChangeInsert(l,E._reviewer,null,false,v);
}}catch(p){C=d.TrackChangesUtils.wrapTextInTrackChangeInsert(l,E._reviewer,null,false,v);
}this.__original_pasteHtml(C,j,h,g,true);
}catch(p){alert("Exception pasting content. Error name: "+p.name+". Error message: "+p.message);
}},_initEvents:function(){if(this.__original__initEvents){try{this.__original__initEvents();
}catch(f){alert("An exception occurred in the script. Error name: "+f.name+". Error message: "+f.message);
}}try{var g=this;
this._containsChangesFromOthers=function(h,i){h=new d.DomRange(h);
return d.TrackChangesUtils.containsChangesFromOthers(h.getHtml());
};
this._deleteChar=function(n,h){var o=n.getParentElement();
if(o.nodeType==3){o=o.parentNode;
}var j=n.cloneRange();
j.moveStart("character",-1);
j.collapse(true);
var p=n.cloneRange();
p.moveEnd("character",1);
p.collapse(false);
var l,m,r,k;
if(h){l=j;
m=p;
whereToAdd1="beforeEnd";
whereToAdd2="afterBegin";
}else{l=p;
m=j;
whereToAdd1="afterBegin";
whereToAdd2="beforeEnd";
}k=d.TrackChangesUtils.findTrackChangesParentElement(l.getParentElement(),g);
if(k){if(k.isInDeleteTrackChangeElement(g._reviewer)){if(k.HtmlElement.parentNode==o){var q=n.getText();
k.HtmlElement.insertAdjacentHTML(whereToAdd1,q==" "?"&nbsp;":q);
return false;
}else{if(o.canHaveHTML){d.TrackChangesUtils.wrapRangeInTrackChangeDelete(n,g._reviewer,null,g);
return true;
}else{d.TrackChangesUtils.wrapElementInTrackChangeDelete(o,g._reviewer,null,g);
return false;
}}}else{n.collapse(false);
n.moveStart("character",-1);
}}k=d.TrackChangesUtils.findTrackChangesParentElement(m.getParentElement(),g);
if(k&&k.isInDeleteTrackChangeElement(g._reviewer)){var i=n.getHtml();
k.HtmlElement.insertAdjacentHTML(whereToAdd2,i==" "?"&nbsp;":i);
return false;
}d.TrackChangesUtils.wrapRangeInTrackChangeDeleteTextOnly(n,g._reviewer,null,g);
return true;
};
this._fixRangeOfElementToSplit=function(){var n=false;
var o=g.getSelection();
if(o&&!o.isControl()){var m=o.getRange();
if(m){var i=new d.DomRange(m);
var p=i.getParentElement();
var q=document.createElement("DIV");
q.innerHTML=i.getHtml();
if(p.tagName=="P"&&q.children.length>1&&q.children.length==q.childNodes.length){var k=g.getSelection().getRange();
if(k){var h=new d.DomRange(k);
var l=h.getText();
h.moveEnd("character",-1);
h.select();
var j=h.getText();
if(l!=j){h.moveEnd("character",1);
h.select();
}n=true;
}}}}return n;
};
this._deleteSelection1=function(j,l,r){this._fixRangeOfElementToSplit();
var p=g._splitSelectionByElements(),h=false;
if(!r){r=new Date().getTime();
}if(p){s(p,r);
h=true;
}else{var q=Telerik.Web.UI.Editor.TrackChangesUtils.markEditorSelection(this);
if(q.newElements.length>0){s(q.newElements,r);
}h=true;
for(var m=0,o=q.newElements.length;
m<o;
m++){d.Utils.removeNode(q.newElements[m++]);
}}if(h){var n=g.get_keyDownEvent();
if(n){try{if(n.keyCode==46){g.getSelection().collapse(false);
}}catch(k){}}}return true;
function s(w,C){if(!("length" in w)){var B=[];
B.push(w);
s(B);
}for(var y=0;
y<w.length;
y++){var v=w[y];
if(v){if("tagName" in v){if(v.tagName.toLowerCase()==b.TagInsert){v.parentNode.removeChild(v);
}else{if(v.tagName.toLowerCase()!=b.TagDelete){var x=(v)?v.tagName:"";
switch(x){case"P":case"TD":case"TR":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":var t=v.childNodes;
s(t,C);
break;
default:d.TrackChangesUtils.wrapElementInTrackChangeDelete(v,g._reviewer,C,g);
d.TrackChangesUtils.removeInsertTrackChangeChildren(v);
break;
}}else{if(v.tagName.toLowerCase()==b.TagDelete){var z=g.getSelection().getRange();
if(z){var u=new d.DomRange(z);
u.selectNodeContents(v);
u.collapse(false);
u.select();
}}}}}else{if("nodeName" in v){d.TrackChangesUtils.wrapElementInTrackChangeDelete(v,g._reviewer,C,g);
}else{if("htmlText" in v){var A=v.parentElement();
if($telerik.getOuterHtml(A)==v.htmlText.replace(/[\r\n]/mg,"")){var B=[];
B.push(A);
s(B);
}else{if(A.tagName.toLowerCase()==b.TagInsert){v.pasteHTML("");
}else{if(A.tagName.toLowerCase()!=b.TagDelete){d.TrackChangesUtils.wrapRangeInTrackChangeDelete(v,g._reviewer,C,g);
}}}}else{s(w[y]);
}}}}}}};
this._deleteSelection=function(i,m,h){var j=d.TrackChangesUtils.getDomRange(g);
var k=j.getParentElement();
var l=j.getText();
if(l&&l.length==1){if(j.getText()!=d.Utils.getTextContent(k)){return this._deleteChar(j,i);
}}return this._deleteSelection1(i,null,m);
};
this._deleteRange=function(m,i){m=d.DomRange.toDomRange(m);
var l=d.TrackChangesUtils.findTrackChangesParentElement(m.getParentElement(),g);
if(l){if(l.isInDeleteTrackChangeElement(null)){return true;
}if(l.isInInsertTrackChangeElement(g._reviewer)){return false;
}}try{var o=m.cloneRange();
o.collapse(true);
var n=d.TrackChangesUtils.findTrackChangesParentElement(o.getParentElement(),g);
var h=!(n&&n.isInDeleteTrackChangeElement(g._reviewer));
var k=m.getHtml();
k=k.replace(/<ins[^>]*>.*?<\/ins>/ig,"");
k=k.replace(/<\/?(?:ins|del)[^>]*>/ig,"");
k=k.replace(/^\s+/ig,"&nbsp;");
if(n&&n.isInInsertTrackChangeElement(g._reviewer)){m.pasteHTML("");
n.HtmlElement.insertAdjacentHTML("afterEnd",d.TrackChangesUtils.wrapTextInTrackChangeDelete(k,g._reviewer));
return true;
}if(h){k=d.TrackChangesUtils.wrapTextInTrackChangeDelete(k,g._reviewer);
}m.pasteHTML(k);
if(!i){o.collapse();
o.select();
}return true;
}catch(j){alert("Cannot perform this operation on the current selection.");
return false;
}};
this._isElementEditable=function(i){var j=true;
var h=i;
while(h&&h.tagName!="body"){if(h.contentEditable=="false"){j=false;
break;
}h=h.parentNode;
}return j;
};
this.attachEventHandler("keypress",function(k){var h=false;
if(k.ctrlKey||k.altKey){h=true;
}else{var q=k.keyCode;
switch(q){case 8:case 13:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 45:case 46:h=true;
}}if(h){return;
}if(!g._canEditSelection()){alert(g.get_localization()["caneditselection"]);
$telerik.cancelRawEvent(k);
return false;
}var v=g.getSelectedElement();
var w=g.getSelection();
var u=d.TrackChangesUtils.getDomRange(g);
var t=d.TrackChangesUtils.findTrackChangesParentElement(v,g);
if(!g.get_enableTrackChanges()||g.get_enableTrackChangesOverride()){if(t){if(t.Type==1||t.Type==2){t.HtmlElement.insertAdjacentHTML("afterEnd","<font id='virtxNewInsertEl'>&nbsp;</font>");
s();
return true;
}else{if(t.Type==5){return true;
}}}return true;
}if(w.isControl()){$telerik.cancelRawEvent(k);
return true;
}if(t&&t.isInInsertTrackChangeElement(g._reviewer)){return;
}var y=d.TrackChangesUtils.getDomRange(g);
var x=d.TrackChangesSelection.locateElementInRange(y,"table");
if(!x.overlapped){if(x.partialOverlapped||y.getHtml().match(new RegExp("<s*td[^>]*>(.*?)<s*/s*td>","ig"))){$telerik.cancelRawEvent(k);
return true;
}}if(u&&u.getHtml()!=""){if(!g._canEditSelection()){$telerik.cancelRawEvent(k);
alert(g.get_localization()["caneditselection"]);
return true;
}n();
g._reselectRange=false;
if(!g._deleteSelection(true)){$telerik.cancelRawEvent(k);
return;
}if(g._reselectRange){u=d.TrackChangesUtils.getDomRange(g);
g._reselectRange=false;
}var r=i();
if(r){var z=g.getTrueParent(r);
t=d.TrackChangesUtils.findTrackChangesParentElement(z,g);
if(!t){t=d.TrackChangesUtils.findTrackChangesParentElement(r,g);
}if(t){t.HtmlElement.insertAdjacentHTML("afterEnd",d.TrackChangesUtils.wrapTextInTrackChangeInsert("&nbsp;",g._reviewer,null,{id:"virtxNewInsertEl"}));
}else{z.insertAdjacentHTML("afterEnd",d.TrackChangesUtils.wrapTextInTrackChangeInsert("&nbsp;",g._reviewer,null,{id:"virtxNewInsertEl"}));
}}else{trackChange=d.TrackChangesUtils.findTrackChangesParentElement(u.getParentElement(),g);
if(trackChange&&trackChange.HtmlElement.tagName.toLowerCase()=="del"){trackChange.HtmlElement.insertAdjacentHTML("afterEnd",d.TrackChangesUtils.wrapTextInTrackChangeInsert("&nbsp;",g._reviewer,null,{id:"virtxNewInsertEl"}));
}else{if(u.getText()!=""){u.getParentElement().insertAdjacentHTML("afterEnd",d.TrackChangesUtils.wrapTextInTrackChangeInsert("&nbsp;",g._reviewer,null,{id:"virtxNewInsertEl"}));
}else{u.pasteHTML(d.TrackChangesUtils.wrapTextInTrackChangeInsert("&nbsp;",g._reviewer,null,{id:"virtxNewInsertEl"}));
}}}s();
return;
}if(t&&t.Type!=5&&t.Type!=3){t.HtmlElement.insertAdjacentHTML("afterEnd",d.TrackChangesUtils.wrapTextInTrackChangeInsert("&nbsp;",g._reviewer,null,{id:"virtxNewInsertEl"}));
s();
return;
}u.pasteHTML(d.TrackChangesUtils.wrapTextInTrackChangeInsert("&nbsp;",g._reviewer,null,{id:"virtxNewInsertEl"}));
s();
function i(){var A=g._splitSelectionByElements();
var B=j(A);
return B;
}function j(B){var C=null;
if(B){if("length" in B){var A=B[B.length-1];
if(A){if("tagName" in A){C=A;
}else{C=j(A);
}}}else{if("tagName" in B){C=B;
}}}return C;
}function n(){var A=g._splitSelectionByElements();
l=null;
o(A);
if(l!=null){if(l.tagName=="TD"||l.tagName=="TR"||l.tagName=="TBODY"){m=null;
p(A);
if(m!=null){m.select();
u=d.TrackChangesUtils.getDomRange(g);
}else{o(A);
if(l!=null){l=null;
o(A);
u.selectNodeContents(l);
u.select();
v=g.getSelectedElement();
if(l.tagName=="TR"){n();
}}}}}}var m;
function p(B){if(B){for(var C=0;
C<B.length;
C++){var A=B[C];
if(A){if(m!=null){break;
}else{if("htmlText" in A){m=A;
break;
}else{p(B[C]);
}}}}}}var l;
function o(B){if(B){for(var C=0;
C<B.length;
C++){var A=B[C];
if(A){if(l!=null){break;
}else{if("tagName" in A){l=A;
break;
}else{o(B[C]);
}}}}}}function s(){var A=g._document.getElementById("virtxNewInsertEl"),B=d.TrackChangesUtils.getDomRange(g);
B.selectNodeContents(A);
if(!$telerik.isFirefox){B.select();
}else{B.collapse();
B.select();
if(A){A.innerHTML="";
}}if(A){A.removeAttribute("id");
}}});
this.attachEventHandler("keydown",function(m){var h=new Date().getTime().toString();
h=parseInt(h);
g.set_keyDownEvent(m);
g.set_copyCommandHit(false);
var C=g.getSelectedElement();
var i=false;
var F=g._shortCutManager.isShortCutHit(m);
if(null!=F){var u=F.get_name();
switch(u){case"Cut":if($telerik.isIE){i=true;
}g.set_copyCommandHit(true);
break;
case"Copy":g.set_copyCommandHit(true);
break;
case"Enter":case"ShiftEnter":case"InsertParagraph":case"Bold":case"Italic":case"Underline":if(!g.get_enableCarriageReturn()){i=true;
}if(!g.get_enableInsertParagraphShortCut()){i=true;
}if(!g.get_enableShiftEnterShortCut()){i=true;
}if(!g.get_enableBoldShortCut()){i=true;
}if(!g.get_enableItalicShortCut()){i=true;
}if(!g.get_enableUnderlineShortCut()){i=true;
}break;
}}if((m.keyCode==46||m.keyCode==8||m.keyCode==13)&&(!g._canEditSelection())){alert(g.get_localization()["caneditselection"]);
i=true;
}if(i){m.keyCode=0;
return $telerik.cancelRawEvent(m);
}var t=m.keyCode;
var D=g.getSelection();
var z=d.TrackChangesUtils.getDomRange(g);
if(t!=37&&t!=38&&t!=39&&t!=40&&!D.isControl()){var q=true;
var l=C.cloneNode(true);
while(l&&l.tagName!="BODY"){if(l.contentEditable=="false"){q=false;
break;
}l=l.parentNode;
}if(!q){$telerik.cancelRawEvent(m);
return true;
}}if(!g.get_enableTrackChanges()||g.get_enableTrackChangesOverride()){var D=g.getSelection();
var z=new d.DomRange(D.getRange());
if(z!=null){if(m.keyCode==8&&!D.isControl()&&z.getText().length==0){var v=true;
var I=z.cloneRange();
I.moveStart("character",-1);
var k=I.getParentElement();
var H=k.nodeName;
if(k&&k.tagName=="TABLE"){I.select();
if(!g._canEditSelection()){z.select();
alert(g.get_localization()["caneditselection"]);
m.keyCode=0;
$telerik.cancelRawEvent(m);
return false;
}else{z.select();
}}}}var o=d.TrackChangesSelection.locateElementInRange(z,"img");
if(!z.range.length&&o.inRange){g._origCutRange=z;
}if((F==null)&&(z.getText()!=""||m.keyCode==8||m.keyCode==46)&&(g.checkIfRangeHasTrackChange())){var x=d.TrackChangesUtils.findTrackChangesParentElement(C,g);
if(x){if(x.Type==1||x.Type==2){x.HtmlElement.insertAdjacentHTML("afterEnd","<font id='virtxNewInsertEl'>&nbsp;</font>");
var w=g._document.getElementById("virtxNewInsertEl");
var z=d.TrackChangesUtils.getDomRange(g);
z.selectNodeContents(w);
z.collapse(false);
z.select();
a(w).remove();
}else{if(x.Type==5){return true;
}}}}return true;
}if(z==null){return;
}if(!D.isControl()){var A=z.cloneRange();
var B=A.cloneRange();
A.collapse(true);
B.collapse(false);
}var I=d.TrackChangesUtils.getDomRange(g);
var G=d.TrackChangesSelection.locateElementInRange(I,"table");
if(!G.overlapped){if(G.partialOverlapped||(!I.range.length&&I.getHtml().match(new RegExp("<s*td[^>]*>(.*?)<s*/s*td>","ig")))){$telerik.cancelRawEvent(m);
return false;
}}g.set_deletedElemName(h.toString());
var n=false;
switch(t){case 46:var D=g.getSelection();
var z=D.getRange();
if(z==null){return;
}z=new d.DomRange(z);
if(!D.isControl()&&z.getHtml().length==0){if($telerik.isIE){do{if(z.moveEnd("character",1)==0){return true;
}}while(z.getHtml().length==0);
}else{z.moveEnd("character",1);
}z.collapse(false);
z.moveStart("character",-1);
D.selectRange(z.range);
}if(!g._canEditSelection()){$telerik.cancelRawEvent(m);
alert(editor.get_localization()["caneditselection"]);
return true;
}var x=d.TrackChangesUtils.findTrackChangesParentElement(D.getParentElement(),g);
if(x){if(x.isInDeleteTrackChangeElement(null)){alert("Element selected has been marked for deletion.");
if(!z.length){z.collapse();
z.select();
}m.keyCode=0;
$telerik.cancelRawEvent(m);
return true;
}if(x.isInInsertTrackChangeElement(g._reviewer)){return true;
}}if(!D.isControl()&&A.getParentElement()!=B.getParentElement()&&B.getParentElement().contentEditable=="true"){if(g._deleteRange(z,true)){$telerik.cancelRawEvent(m);
}}else{if(D.isControl()){d.TrackChangesUtils.wrapElementInTrackChangeDelete(g.getSelectedElement(),g._reviewer,null,g);
$telerik.cancelRawEvent(m);
}else{if(g.getSelectedElement()){var y=d.TrackChangesSelection.locateElementInRange(z,"placeholder");
if(g.getSelectedElement().contentEditable=="true"&&g.getSelectedElement().tagName.toLowerCase()=="a"){d.TrackChangesUtils.wrapElementInTrackChangeDelete(g.getSelectedElement(),g._reviewer,null,g);
$telerik.cancelRawEvent(m);
}else{if(G.overlapped||n){var j=D.getRange().htmlText.replace(new RegExp("<s*ins[^>]*>(.|\n)*?<s*/s*ins>","ig"),"");
d.TrackChangesUtils.wrapCutElement(j,g._reviewer,null,g,D.getRange());
$telerik.cancelRawEvent(m);
}else{if(g._deleteSelection(true,h)){$telerik.cancelRawEvent(m);
}}}}}}return true;
case 8:var D=g.getSelection();
var z=D.getRange();
if(z==null){return;
}z=new d.DomRange(z);
if(!D.isControl()&&z.getHtml().length==0){var v=true;
var I=z.cloneRange();
I.moveStart("character",-1);
var k=I.getParentElement();
var r=k.nodeName=="IMG";
if(I.getHtml().length<1||r){var p=k.contentEditable;
var H=k.nodeName;
var s=(H=="A"&&p.match(/(true|false)/i));
if(H=="TABLE"||s||r){v=false;
editor.selectElement(k);
}}else{if(v){do{if(z.moveStart("character",-1)==0){return true;
}}while(z.getHtml().length==0);
z.collapse(true);
z.moveEnd("character",1);
D.selectRange(z.range);
}}}if(!g._canEditSelection()){alert(editor.get_localization()["caneditselection"]);
m.keyCode=0;
$telerik.cancelRawEvent(m);
return false;
}var x=d.TrackChangesUtils.findTrackChangesParentElement(D.getParentElement(),g);
if(x){if(x.isInDeleteTrackChangeElement(null)){z.collapse(true);
z.select();
$telerik.cancelRawEvent(m);
return true;
alert("Element selected has been marked for deletion.");
if(!z.length){z.collapse();
z.select();
}m.keyCode=0;
$telerik.cancelRawEvent(m);
return true;
}if(x.isInInsertTrackChangeElement(g._reviewer)){return true;
}}if(D.isControl()){d.TrackChangesUtils.wrapElementInTrackChangeDelete(D.getParentElement(),g._reviewer,null,g);
$telerik.cancelRawEvent(m);
return true;
}var E=z.cloneRange();
E.collapse(true);
if(!D.isControl()&&A.getParentElement()!=B.getParentElement()&&B.getParentElement().contentEditable=="true"){if(g._deleteRange(z,false)){$telerik.cancelRawEvent(m);
E.collapse(true);
E.select();
D.selectRange(E.range);
}}else{if(G.overlapped||n){var j=D.getRange().htmlText.replace(new RegExp("<s*ins[^>]*>(.|\n)*?<s*/s*ins>","ig"),"");
d.TrackChangesUtils.wrapCutElement(j,g._reviewer,null,g,D.getRange());
$telerik.cancelRawEvent(m);
}else{if(g._deleteSelection(false)){$telerik.cancelRawEvent(m);
E.collapse(true);
E.select();
D.selectRange(E.range);
}}}return true;
}return true;
});
}catch(f){alert("An exception occurred in the script. Error name: "+f.name+". Error message: "+f.message);
}},setForamtTrackChangesAttributes:function(h,g){var i=new Date().getTime();
h.setAttribute(b.Attribute.Author,this._reviewer);
if(h.tagName=="TABLE"&&h.className!=""){var f=b.CssClassFormat;
if(h.className.indexOf(f)==-1){h.className=b.CssClassFormat+" "+h.className;
}}else{h.className=b.CssClassFormat;
}h.setAttribute(b.Attribute.BrowserCommand,g);
h.setAttribute(b.Attribute.Timestamp,i);
h.setAttribute(b.Attribute.Title,"Formatted by "+this._reviewer+" on "+new Date(i).toLocaleString());
},setJustifyForamtTrackChangesAttributes:function(j,i,g,f){var h=j.getAttribute("alignOrig");
if(!h){j.setAttribute("alignOrig",g?g:"none");
}var k=j.style;
k.textAlign=f?f:"";
if(this.get_enableTrackChanges()||!this.get_enableTrackChangesOverride()){this.setForamtTrackChangesAttributes(j,i);
}},_splitSelectionByElements:function(){var i=this;
var m=i.getSelection();
var h=m?m.isControl():false;
if((!m||m.getText()=="")&&!h){return null;
}if(h){return[m.getParentElement()];
}var j=d.TrackChangesUtils.getDomRange(i);
this.storeSelection(j);
var o=j.cloneRange();
var k=j.getParentElement();
if(k.nodeName=="HTML"){return null;
}if(k.nodeName=="LI"){do{if(k.parentElement==null){return null;
}k=k.parentElement;
var n=k.tagName;
}while(n=="UL"||n=="OL"||d.Utils.isEditorContentArea(k));
}var l=f(k);
this.restoreSelection(j);
return l;
function f(r){if(r.innerHTML===null||r.innerHTML===""){var t=false;
o=j.cloneRange();
o.selectNodeContents(r);
if(r.tagName&&r.nodeName=="IMG"){t=true;
}else{if(!o.getText()){return null;
}}if(o==null){return null;
}if(j.inRange(o)){if(r.parentElement&&t&&$telerik.getOuterHtml(r)==r.parentElement.innerHTML){return r.parentElement;
}else{return r;
}}if(o.inRange(j)){if(t){if(r.parentElement&&$telerik.getOuterHtml(r)==r.parentElement.innerHTML){return r.parentElement;
}else{return r;
}}else{return j.cloneRange();
}}if(j.compareBoundaryPoints(e.Editor.DomRange.START_TO_END,o)==-1&&j.compareBoundaryPoints(e.Editor.DomRange.END_TO_START,o)==1){if(j.compareBoundaryPoints(e.Editor.DomRange.START_TO_START,o)==-1){o.snapToRange(d.DomRange.END_TO_END,j);
}else{o.snapToRange(d.DomRange.START_TO_START,j);
}if(o.getHtml()!=$telerik.getOuterHtml(r)&&r.innerHTML==""){if(r.parentElement&&r.parentElement.innerHTML==$telerik.getOuterHtml(r)){return r.parentElement;
}else{return r;
}}return o.cloneRange();
}return null;
}if(r.nodeType==3){o.setStart(r,0);
o.setEnd(r,r.length);
}else{o.selectNodeContents(r);
}if(!d.TrackChangesUtils.intersect(o,j)){return null;
}if(j.inRange(o)){return[r];
}var w=[];
var q=r.childNodes;
for(var s=0,u=q.length;
s<u;
s++){var p=q[s];
var v=f(p);
if(v){w.push(v);
}}if(w.length==0){return null;
}return w;
}function g(u){var p=null;
try{if($telerik.isIE){p=u.ownerDocument.body;
var w=p.createTextRange();
var y=p.createTextRange();
var x=t(u);
if(x){y.moveToElementText(x);
w.setEndPoint("StartToEnd",y);
}else{y.moveToElementText(u.parentNode);
w.setEndPoint("StartToStart",y);
}x=s(u);
if(x){y.moveToElementText(x);
w.setEndPoint("EndToStart",y);
}else{y.moveToElementText(u.parentNode);
w.setEndPoint("EndToEnd",y);
}var v;
v=w.duplicate();
v.collapse();
do{if(v.moveEnd("character",1)==0){break;
}}while(v.htmlText.length==0);
v.moveEnd("character",-1);
w.setEndPoint("StartToEnd",v);
v=w.duplicate();
v.collapse(false);
do{if(v.moveStart("character",-1)==0){break;
}}while(v.htmlText.length==0);
v.moveStart("character",1);
w.setEndPoint("EndToStart",v);
return w;
}else{return null;
}}catch(q){return null;
}function t(z){var A=z;
try{while(A.previousSibling){if(A.previousSibling.tagName){return A.previousSibling;
}else{A=A.previousSibling;
}}}catch(r){}return null;
}function s(z){var A=z;
try{while(A.nextSibling){if(A.nextSibling.tagName){return A.nextSibling;
}else{A=A.nextSibling;
}}}catch(r){}return null;
}}},storeSelection:function(g){var f=d.DomRange.toDomRange(g);
this._rangeStorage=f.cloneRange();
},restoreSelection:function(i){var h=this;
var g=h.get_keyDownEvent();
if(g){if("keyCode" in g){try{if(g.shiftKey&&(g.keyCode==37||g.keyCode==38||g.keyCode==39||g.keyCode==40)){return;
}}catch(f){}}}if(this._rangeStorage){this._rangeStorage.select();
}},_onResizeEnd:function(f){var g=this.getSelection();
var h=g.getParentElement();
var i=h.attributes.tagid;
if(i){h.removeAttribute("width");
h.removeAttribute("height");
h.style.cssText="display: inline; background-color: lightgrey;";
}if((h.tagName=="SPAN"||h.tagName=="FONT")&&h.contentEditable=="false"){h.style.cssText="display: inline; background-color: lightgrey;";
}this.__original_onResizeEnd(f);
},getToolState:function(g){switch(g){case"AcceptAllTrackChanges":case"AcceptTrackChange":case"AcceptTrackChanges":case"RejectAllTrackChanges":case"RejectTrackChange":case"RejectTrackChanges":case"RemoveTrackChanges":case"RemoveAllComments":case"RemoveComment":case"AddComment":case"EnableTrackChanges":case"EnableTrackChangesOverride":var f=e.Editor.UpdateCommandsArray[g];
f.set_editor(this);
if(f&&f.getState){return f.getState(this.get_contentWindow());
}break;
}return this.__original_getToolState(g);
},_onDragStart:function(f){this._iRange=d.TrackChangesUtils.getDomRange(this);
var i=d.TrackChangesSelection.locateElementInRange(this._iRange,"a");
if(i.inRange){d.isHyperLink=true;
}if(this.getSelectedElement()){if((this.getSelectedElement().tagName.toLowerCase()=="span"||this.getSelectedElement().tagName.toLowerCase()=="font")&&this.getSelectedElement().contentEditable=="false"&&this.getSelectedElement().parentElement){d.placeHolderID=(new Date()-100);
this.getSelectedElement().parentElement.id=d.placeHolderID;
d.isPlaceHolder=true;
}}var g=null;
if(this.checkIfRangeHasTrackChange(g)){alert("Cannot drag a selection that have track changes or comment");
return false;
}fromEditor=this;
var o=this._iRange.getHtml();
if(this._iRange.getText()){var j=this._iRange.getParentElement();
var k=d.Utils.getTextContent(j);
if(j&&k==this._iRange.getText()){var l=j.tagName;
switch(l){case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":o=d.Utils.getTextContent(j);
break;
}}f.dataTransfer.setData("Text",o);
}d.isControlOnDrag=false;
if(this.get_enableTrackChanges()){try{this._iRange=d.TrackChangesUtils.getDomRange(this);
this._cachedRange=this._iRange;
if(this._contentWindow.document.selection.type==="Control"){oElement=this._iRange.getParentElement();
range=d.TrackChangesUtils.getDomRange(this);
range.selectNodeContents(oElement);
this._iRange=range;
if(oElement.tagName=="TABLE"||oElement.tagName=="FONT"||oElement.tagName=="SPAN"){this._iRange.moveStart("word",-1);
this._iRange.moveEnd("word",1);
}f.dataTransfer.setData("Text",$telerik.getOuterHtml(oElement));
if(oElement.tagName.toLowerCase()=="img"){d.isControlOnDrag=true;
}}else{f.dataTransfer.setData("Text",o);
}}catch(h){d.isControlOnDrag=true;
}var n=this.get_localization()["MoveCommand"]||"Move";
this._pendingMoveCommand=new d.GenericCommand(n,this.get_contentWindow());
this._startRange=null;
if(!f.ctrlKey&&!f.ctrlLeft){this._startRange=d.TrackChangesUtils.getDomRange(this);
if(this.getSelection().isControl()){var m=d.TrackChangesUtils.getDomRange(this);
e.RadEditor.prototype._elementToMove=this.getSelectedElement();
if("IMG"==e.RadEditor.prototype._elementToMove.tagName&&"A"==e.RadEditor.prototype._elementToMove.parentNode.tagName&&e.RadEditor.prototype._elementToMove.parentNode.childNodes.length==1){e.RadEditor.prototype._elementToMove=e.RadEditor.prototype._elementToMove.parentNode;
}m.selectNodeContents(e.RadEditor.prototype._elementToMove);
this._startRange=m;
this._iRange=m;
if(d.isPlaceHolder){f.dataTransfer.setData("Text",e.RadEditor.prototype._elementToMove.innerHTML);
}else{f.dataTransfer.setData("Text",$telerik.getOuterHtml(e.RadEditor.prototype._elementToMove));
}}}if(f.dataTransfer.getData("Text")==null){return false;
}}},_onDrop:function(h){d.hasBeenDropped=true;
d.dragIsCancelled=false;
if(!this._iRange){return false;
}var m=this;
if(this.get_enableTrackChanges()){var q=m.getSelectedElement();
var p=d.TrackChangesUtils.getDomRange(m);
var n=d.TrackChangesUtils.findTrackChangesParentElement(q,m);
var i=false;
var r=false;
if(n){i=e.RadEditor.prototype.checkIfRangeIsInEndOfElement(n.HtmlElement,p);
r=e.RadEditor.prototype.checkIfRangeIsInStartOfElement(n.HtmlElement,p);
}if(i||r){p.selectNodeContents(n.HtmlElement);
p.select();
if(i){e.RadEditor.prototype._insertTagAdjacentElement("afterEnd","font","&nbsp;",true);
}else{if(r){e.RadEditor.prototype._insertTagAdjacentElement("beforeBegin","font","&nbsp;",true);
}}}q=m.getSelectedElement();
if(n){var k=m._isTrackChangeElementByAnotherUser(n.HtmlElement,n.HtmlElement.tagName.toLowerCase());
if(k){d.dragIsCancelled=true;
alert("Cannot alter text modified by other reviewers.");
return false;
}}if(p.getParentElement()){if((d.isHyperLink||d.isPlaceHolder)&&p.getParentElement().tagName.toLowerCase()=="a"){d.dragIsCancelled=true;
return false;
}}var g=d.TrackChangesSelection.locateElementInRange(p,"del");
n=d.TrackChangesUtils.findTrackChangesParentElementFormatExcluded(q,m);
if(n==null||g.inRange==false){if(this.get_enableTrackChanges()&&this.get_enableTrackChangesOverride()==false){var l=p.cloneRange();
if(!d.isControlOnDrag){var t=new Date().getTime();
var o=d.TrackChangesUtils.findTrackChangesParentElementFormatExcluded(this._iRange.getParentElement(),m);
if(o!=null&&o.HtmlElement.tagName.toLowerCase()!="font"){if(!o.isInDeleteTrackChangeElement(null)){l.pasteHTML(d.TrackChangesUtils.wrapTextInTrackChangeInsert(h.dataTransfer.getData("Text"),this._reviewer,t));
}this._iRange.pasteHTML(h.dataTransfer.getData("Text"));
}else{var f=this._cachedRange;
if(f){f.select();
if(this._deleteSelection){this._deleteSelection(true);
}this._cachedRange=null;
}this.getSelection().collapse(false);
if(d.isPlaceHolder){if(e.RadEditor.prototype._elementToMove){var j="<A contentEditable=true>"+$telerik.getOuterHtml(e.RadEditor.prototype._elementToMove)+"</A>";
l.pasteHTML(d.TrackChangesUtils.wrapTextInTrackChangeInsert(j,this._reviewer,t));
}}else{l.pasteHTML(d.TrackChangesUtils.wrapTextInTrackChangeInsert(h.dataTransfer.getData("Text"),this._reviewer,t));
}}}else{try{if(d.isPlaceHolder){if(e.RadEditor.prototype._elementToMove){l.pasteHTML("<A contentEditable=true>"+$telerik.getOuterHtml(e.RadEditor.prototype._elementToMove)+"</A>");
}this._iRange.pasteHTML("");
}else{element=m.getSelectedElement();
if(e.RadEditor.prototype._elementToMove&&e.RadEditor.prototype._elementToMove.tagName.toLowerCase()=="table"){e.RadEditor.prototype._elementToMove.innerHTML="";
e.RadEditor.prototype._elementToMove=null;
}else{this._iRange.pasteHTML("");
}if(element){i=e.RadEditor.prototype.checkIfRangeIsInEndOfElement(element,l);
r=e.RadEditor.prototype.checkIfRangeIsInStartOfElement(element,l);
}if(i||r){p.selectNodeContents(element);
p.select();
if(i){element.insertAdjacentHTML("afterEnd",h.dataTransfer.getData("Text"));
}else{if(r){element.insertAdjacentHTML("beforeBegin",h.dataTransfer.getData("Text"));
}}}else{l.pasteHTML(h.dataTransfer.getData("Text"));
}if(e.RadEditor.prototype._elementToMove){e.RadEditor.prototype._elementToMove.innerHTML="";
e.RadEditor.prototype._elementToMove=null;
}l=null;
element=null;
}}catch(h){}}h.returnValue=false;
}else{try{if(d.isPlaceHolder){l=d.TrackChangesUtils.getDomRange(m);
if(e.RadEditor.prototype._elementToMove){l.pasteHTML("<A contentEditable=true>"+$telerik.getOuterHtml(e.RadEditor.prototype._elementToMove)+"</A>");
}this._iRange.pasteHTML("");
h.returnValue=false;
}else{l=d.TrackChangesUtils.getDomRange(m);
element=m.getSelectedElement();
if(e.RadEditor.prototype._elementToMove&&e.RadEditor.prototype._elementToMove.tagName.toLowerCase()=="table"){e.RadEditor.prototype._elementToMove.innerHTML="";
e.RadEditor.prototype._elementToMove=null;
}else{this._iRange.pasteHTML("");
}if(element){i=e.RadEditor.prototype.checkIfRangeIsInEndOfElement(element,l);
r=e.RadEditor.prototype.checkIfRangeIsInStartOfElement(element,l);
}if(i||r){p.selectNodeContents(element);
p.select();
if(i){element.insertAdjacentHTML("afterEnd",h.dataTransfer.getData("Text"));
}else{if(r){element.insertAdjacentHTML("beforeBegin",h.dataTransfer.getData("Text"));
}}}else{l.pasteHTML(h.dataTransfer.getData("Text"));
}if(e.RadEditor.prototype._elementToMove){e.RadEditor.prototype._elementToMove.innerHTML="";
e.RadEditor.prototype._elementToMove=null;
}l=null;
element=null;
h.returnValue=false;
}}catch(h){}}}else{d.dragIsCancelled=true;
h.returnValue=false;
alert("Cannot alter text that has been mark as deleted.");
}this._saveTypedContent(false,"on drop operation executing");
var s=this.get_localization()["Drop"]||"Drop external content";
this._pendingDockCommand=new d.GenericCommand(s,this._contentWindow);
this._cachedRange=null;
if(l){l.select();
}}},_onDragEnd:function(f){if(d.dragIsCancelled){if(d.isPlaceHolder){var l=editor.get_document().getElementById(d.placeHolderID);
if(l){l.removeAttribute("id");
}}var i=true;
var g=e.RadEditor.prototype._elementToMove;
if(e.RadEditor.prototype._elementToMove){if(g.tagName.toLowerCase()=="tbody"||g.tagName.toLowerCase()=="table"){i=false;
}}e.RadEditor.prototype._elementToMove=null;
if(i){try{this._iRange.pasteHTML("");
var k=this._iRange.getParentElement();
if(this.checkIfRangeIsInStartOfElement(k,this._iRange)==true&&this.checkIfRangeIsInEndOfElement(k,this._iRange)==false){var h=(new Date()-100);
k.insertAdjacentHTML("beforeBegin","<FONT id='"+h+"' ></FONT>");
var j=this.get_document().getElementById(h);
j.removeAttribute("id");
j.outerHTML=f.dataTransfer.getData("Text");
}else{this._iRange.pasteHTML(f.dataTransfer.getData("Text"));
}}catch(f){}}}else{if(d.isPlaceHolder&&d.hasBeenDropped&&(this.get_enableTrackChanges()==false||(this.get_enableTrackChanges()==true&&this.get_enableTrackChangesOverride()==true))){var l=this.get_document().getElementById(d.placeHolderID);
if(l){l.removeAttribute("id");
l.innerHTML="";
}}}d.placeHolderID=null;
d.isPlaceHolder=false;
this._iRange=null;
d.dragIsCancelled=false;
d.hasBeenDropped=false;
d.isHyperLink=false;
e.RadEditor.prototype._elementToMove=null;
this._cachedRange=null;
},enableContentArea:function(g){if(this.isIE){if(!g){var f=d.TrackChangesUtils.getDomRange(this);
if(f.getHtml()==""){this.enableContentAreaRange=f;
}}this.get_contentArea().setAttribute("contentEditable",""+g);
if(g&&this.enableContentAreaRange){this.enableContentAreaRange.select();
this.enableContentAreaRange=null;
}}},getTrueParent:function(f){function g(h){if(h){if(h.parentElement){if($telerik.getOuterHtml(h)==h.parentElement.innerHTML){return g(h.parentElement);
}}}return h;
}return g(f);
},checkIfRangeHasTrackChange:function(h){var m=d.TrackChangesSelection;
var l=new d.DomRange(this.getSelection().getRange());
var g=m.locateElementInRange(l,"del");
var i=m.locateElementInRange(l,"ins");
var f=m.locateElementInRange(l,"comment");
var j=m.locateElementInRange(l,"placeholder");
var k=false;
if(j.fullySelected&&l.getText().length){element=l.getParentElement().parentElement.parentElement;
if(element.tagName.toLowerCase()=="ins"||element.tagName.toLowerCase()=="del"){k=true;
}}if(i.inRange||g.inRange||f.inRange){k=true;
}return k;
},checkIfRangeIsInEndOfElement:function(h,l){l=d.DomRange.toDomRange(l);
var p=false;
if(l&&h){var i=d.Utils.getTextContent(h)||"";
var k=i.replace("\r","").length;
var o="";
var j="";
var m=l.cloneRange();
var n=l.cloneRange();
try{m.moveStart("character",-k);
j=m.getText().replace(/[\r\n]/mg,"");
f(h);
}catch(g){}l.select();
}return p;
function f(q){n.selectNodeContents(q);
o=n.getText().replace(/[\r\n]/mg,"");
if(o==j){p=true;
}if(j.length>o.length){if(q.parentElement){f(q.parentElement);
}}}},checkIfRangeIsInStartOfElement:function(h,l){l=d.DomRange.toDomRange(l);
var p=false;
if(l&&h){var i=d.Utils.getTextContent(h)||"";
var k=i.replace("\r","").length;
var o="";
var j="";
var m=l.cloneRange();
var n=l.cloneRange();
try{m.moveEnd("character",k);
j=m.getText().replace(/[\r\n]/mg,"");
f(h);
}catch(g){}l.select();
}return p;
function f(q){n.selectNodeContents(q);
o=n.getText().replace(/[\r\n]/mg,"");
if(o==j){p=true;
}if(j.length>o.length){if(q.parentElement){f(q.parentElement);
}}}},_insertTagAdjacentElement:function(k,o,j,h){if(null==k){k="afterEnd";
}if(null==j){j="&nbsp";
}if(null==o){o="font";
}var p=this._document.getElementById("vrtxInsertElement");
var f=k=="afterEnd"?false:true;
if(!p||p==undefined){var n=this.getSelectedElement();
var m=d.TrackChangesUtils.findTrackChangesParentElement(n,this);
if(m){m.HtmlElement.insertAdjacentHTML(k,"<"+o+' id="vrtxInsertElement">'+j+"</"+o+">");
}else{if(n.tagName.toLowerCase()=="td"){n=n.children[0];
}n.insertAdjacentHTML(k,"<"+o+' id="vrtxInsertElement">'+j+"</"+o+">");
}p=this._document.getElementById("vrtxInsertElement");
}if(p){try{p.removeAttribute("id");
this.selectElement(p);
if(h){if(f){var l=this.getSelection().getRange();
var i=l.findText(" ");
if(i){l.select();
l.collapse(false);
}}else{this.getSelection().collapse(f);
p.innerHTML="";
}}else{this.getSelection().collapse(f);
}}catch(g){return false;
}}return true;
},set_enableTrackChangesOverride:function(f){this._enableTrackChangesOverride=f?true:false;
},shouldTrackChanges:function(){return this.get_enableTrackChanges()&&!this.get_enableTrackChangesOverride();
},get_isAuthor:function(){return true;
},set_isAuthor:function(f){this._isAuthor=f?true:false;
},set_author:function(f){_author=f;
this.set_reviewer(f);
},set_userCssId:function(f){this._userCssId=f;
b.CssClassInsert=b.CssClassDelete=this._userCssId;
b.CssClassComment=b.CssClassNamePrefixComment+" "+this._userCssId;
b.CssClassFormat=b.CssClassNamePrefixFormat+" "+this._userCssId;
b.CssClassInsertTR=b.CssClassNamePrefixInsertTR+" "+this._userCssId;
b.CssClassDeleteTR=b.CssClassNamePrefixDeleteTR+" "+this._userCssId;
},get_contextMenuItemsToDisable:function(){return this._contextMenuItems;
},set_contextMenuItemsToDisable:function(f){this._contextMenuItems=f;
},set_clipboardData:function(f){if(typeof(PasteFlag)!="undefined"){PasteFlag._set(f);
}else{this._clipboardData=f;
}},get_clipboardData:function(){if(typeof(PasteFlag)!="undefined"){return PasteFlag._get();
}else{return this._clipboardData;
}},moveToParagraphInserted:function(q,f){if(q.get_paragraphInserted()){var p=q.getSelection();
if(!p.isControl()){var n=p.getParentElement();
var m=n.lastChild;
var h=f;
try{if(m&&m.nodeName!="P"){var g=m.children;
while(g.length>0){if(g.length==1){if(l(g[0])){m=g[0];
break;
}g=g[0].children;
}else{if(g.length>1){for(var k=0;
k<g.length;
k++){if(l(g[k])){m=g[k];
break;
}}break;
}}}}}catch(j){}if(m&&l(m)){m.innerText=m.textContent=h;
q.selectElement(m);
var o=p.getRange();
q.set_paragraphInserted(false);
return o;
}else{if(m.nodeName=="IMG"){}}}}function l(i){var r=d.Utils.getTextContent(i)||"";
return(i.nodeName=="P"&&r=="");
}q.set_paragraphInserted(false);
return false;
},executeTrackChangesCommand:function(g,f,k,h){var i=this._localization[g];
var j=null;
switch(g){case"AcceptTrackChange":case"AcceptTrackChanges":j=new d.TrackChangesCommands.AcceptTrackChanges(i,this,null);
break;
case"RejectTrackChange":case"RejectTrackChanges":j=new d.TrackChangesCommands.RejectTrackChanges(i,this,null);
break;
case"RemoveTrackChanges":case"RemoveComment":j=new d.TrackChangesCommands.RemoveTrackChanges(i,this,null);
break;
case"AddComment":j=new d.TrackChangesCommands.AddComment(i,this,null);
break;
default:alert(g+" track change command is not implemented yet.");
}this.executeCommand(j);
this.setActive();
this.setFocus();
this.raiseEvent("selectionChange",Sys.EventArgs.Empty);
},_canExecuteTrackChangeCommand:function(){if(this.get_isAuthor()){return true;
}var g=this.getSelection();
var h=g.getParentElement();
if(!h){return false;
}var f=h.nodeType!=3?h:h.parentNode;
return !this.isInProhibitedParentElement(f);
},_canEditSelection:function(i){if(!i){i=this.getSelection();
}var g=this;
var j=i.getParentElement();
if(!j||this.isInProhibitedParentElement(j)){return false;
}var h=this._splitSelectionByElements();
if(h&&f(h)){return false;
}return true;
function f(m){for(var l=0;
l<m.length;
l++){var k=m[l];
if(k){if("tagName" in k){if(g._isTrackChangeElementByAnotherUser(k,k.tagName.toLowerCase())){return true;
}if(k.childNodes.length>0&&f(k.childNodes)){return true;
}continue;
}else{if("nodeName" in k){c=k.parentNode;
}else{if("htmlText" in k){c=k.parentElement();
}else{if(f(k)){return true;
}continue;
}}}if(c.tagName&&g._isTrackChangeElementByAnotherUser(c,c.tagName.toLowerCase())){return true;
}}}return false;
}},isInProhibitedParentElement:function(h){var f=this.get_contentArea();
for(var g=h;
g&&g!=f;
g=g.parentNode){if(g.nodeType==1&&this._isTrackChangeElementByAnotherUser(g,g.tagName.toLowerCase())){return true;
}}return false;
},_isTrackChangeElementByAnotherUser:function(f,g){return false;
},get_paragraphs:function(){if(null==this._paragraphs){return[["<p>","Normal"],["<h1>","<h1>Heading 1</h1>"],["<h2>","<h2>Heading 2</h2>"],["<h3>","<h3>Heading 3</h3>"],["<h4>","<h4>Heading 4</h4>"],["<h5>","<h5>Heading 5</h5>"],["<h6>","<h6>Heading 6</h6>"],["<p class='MsoHeading7'>","<p class='MsoHeading7'>Heading 7</p>"],["<p class='MsoHeading8'>","<p class='MsoHeading8'>Heading 8</p>"],["<h5>","<dir>Directory List</dir>"],["<menu>","<menu>Menu List</menu>"],["<pre>","<pre>Formatted</pre>"],["<address>","<address>Address</address>"]];
}return this._paragraphs;
},addToStack:function(h){var f=Telerik.Web.UI;
var g=new f.Editor.GenericCommand(h,this._contentWindow);
var i=this.get_commandsManager();
i.execute(g,true);
},removeFromStack:function(g){var i=this.get_commandsManager();
var h=i.get_commands();
var f=h.length;
if(f>0){if(g==h[f-1]._title){i.removeCommandAt(f-1);
}}}});
})(Telerik.Web.UI,$telerik.$,Telerik.Web.UI.Editor,Telerik.Web.UI.Editor.TrackChangesConstants);
Type.registerNamespace("Telerik.Web.UI");
Type.registerNamespace("Telerik.Web.UI.Editor");
(function(d,a,c,b){c.TrackChanges=(function(){var l=null;
var m=null;
var A=null;
var z=null;
var B=null;
var i=null;
var F=null;
var N=false;
var Q="Reject";
var e=$telerik.$;
var x=function(R){l=R;
m=R._contentArea;
L();
};
var L=function(){z=false;
B=false;
A=false;
i=0;
F=0;
};
var J=function(){l.get_document().execCommand("SelectAll",false,null);
l.getSelection().collapse();
return;
};
var K=function(R){l=R;
m=R.get_contentArea();
};
var t=function(R){return s(R).concat(s("TABLE"));
};
var q=function(S){var R=b.CssClassNamePrefixComment;
return r(S,R).concat(r("TABLE",R));
};
var u=function(T){var S=[];
var U=m.getElementsByTagName(T);
if(U.length>0){for(var R=0;
R<U.length;
R++){if(P(U[R])){S.push(U[R]);
}}}return S;
};
var s=function(R){return r(R,b.CssClassNamePrefixFormat);
};
var r=function(S,R){return e(m).find(S+"."+R).toArray();
};
var P=function(R){if(R.nodeName=="#text"){return false;
}return true;
};
var v=function(){var S=[];
if(A){var V=q("font");
if(V.length<1){V=q("span");
}S.push(V);
}else{var R=u("ins");
var U=u("del");
var T=t("");
S.push(R);
S.push(U);
S.push(T);
}return S;
};
var w=function(){e("#rade_tccomment_divEdit_id_"+l._clientStateFieldID).hide();
e("#rade_tccomment_divView_id_"+l._clientStateFieldID).hide();
e("#rade_tccomment_divInfo_id_"+l._clientStateFieldID).hide();
};
var p=function(S,T){try{var U=c.TrackChangesUtils.getDomRange(l);
U.selectNodeContents(S);
U.select();
if(T){w();
}return true;
}catch(R){return false;
}};
var h=function(){return l.get_isAuthor()?true:l._canEditSelection();
};
var o=function(){Q=!l.get_canRejectTrackChange()?"Remove":"Reject";
try{window.setTimeout(function(){var S=A?"Remove All Comments":z?"Accept All Changes":Q+" All Changes";
c.Dialogs.showConfirm("Do you want to proceed anyway?",S,l.get_skin(),function(T){if(T){c.Dialogs.showOverlay();
l.setFocus();
g();
}else{L();
}});
},1);
}catch(R){alert("Error encountered while executing the command...");
}};
var g=function(){var S=0;
var R=A?"RemoveTrackChanges,Remove All Comments":z?"AcceptTrackChanges,Accept All Changes":"RejectTrackChanges,"+Q+" All Changes";
var V=v();
for(var W=0;
W<V.length;
W++){for(var X=0;
X<V[W].length;
X++){var U=V[W][X];
if(U.tagName){if(p(U,true)&&h()){try{l.executeTrackChangesCommand(R.split(",")[0],false,null,null);
i++;
S++;
}catch(T){continue;
}}}}}if(G(S)){n(R);
}};
var G=function(R){if(i>0&&R>0){F++;
if(A){if(F>10){return true;
}}else{if(F>5){return true;
}}O(10);
g();
return false;
}return true;
};
var n=function(R){if(F>2){i--;
var S=z;
window.setTimeout(function(){I(S);
},1000);
}var U=R.split(",")[1];
var T="Changes successfully executed.";
if(i<1){T="No changes has been made.";
}J();
L();
if(!N){c.Dialogs.showAlert(T,U,l.get_skin());
}};
var I=function(X){var ac="<s*ins.*?>";
var ab="<s*/s*inss*.*?>";
var ae="<s*p.*?>";
var ad="<s*/s*ps*.*?>";
var aa="<(.|\n)*?>";
var W=u("ins");
var S=u("del");
var R=q("font");
if(R.length>0){for(var U=0;
U<R.length;
U++){af(R[U]);
}}if(W.length>0){for(var V=0;
V<W.length;
V++){af(W[V]);
}}if(S.length>0){for(var Y=0;
Y<S.length;
Y++){af(S[Y]);
}}function af(ah){if(ah){var ak=ah.parentElement;
var al=document.createElement("FONT");
if(P(ah)&&(ah.tagName=="DEL"||ah.tagName=="INS")){if(p(ah,true)&&h()){try{if(ah.innerHTML.indexOf("<HR>")>-1&&ah.tagName=="INS"){}var aj=c.Utils.getTextContent(ah);
var ai=ah.innerHTML;
if(aj.trim()!=""){if((ah.nodeName=="INS"&&X)||(ah.nodeName=="DEL"&&!X)){al.innerHTML=ai;
ak.replaceChild(al,ah);
}else{ak.removeChild(ah);
}}else{ak.removeChild(ah);
}}catch(ag){return;
}}}if(P(ah)&&ah.className.match(b.CommentsRegex)){if(p(ah,true)&&h()){al.innerHTML=ah.innerHTML;
ak.replaceChild(al,ah);
}}}}function T(al){var aw=Z(al);
al.id="junkID";
var am=X?"HR":"";
var ao=l._document.getElementById(al.id);
var ap=ao.parentElement;
var an=l._document.createElement(am);
ap.replaceChild(an,ao);
if(!X&&!aw){var aj=ap.tagName;
if(aj=="P"){var ai=ap.parentElement;
var ah=ai.innerHTML;
var ak=c.Utils.getTextContent(ai);
var at=ah.match(new RegExp(aa,"ig"));
var au=at.length;
if(au>3&&at[0].indexOf(aj)>-1){var ag=true;
var av=at[0];
for(var aq=2;
aq<au;
aq++){if(aq%2!=1){if(at[aq]!=av){ag=false;
}}if(!ag){break;
}}if(ag){var ar=av+ak+"</P>";
ai.innerHTML=ar;
}}}}}function Z(ag){var am=ag.innerHTML;
var au=new RegExp(ae,"ig").test(am);
var ai=new RegExp(ad,"ig").test(am);
if(au&&ai){var aq=ag;
while(aq.tagName!="BODY"){aq=aq.parentElement;
var ar=aq.innerHTML;
var at=new RegExp(ac,"ig").test(ar);
var ah=new RegExp(ab,"ig").test(ar);
if(at&&ah){break;
}}if(aq.tagName!="BODY"){var ak=ar.match(new RegExp(aa,"ig"));
var av=ak.length;
if(av>0){var al=ak.find("<HR>");
var aj=ak[0];
var ap=ak[av-1];
var ao=new RegExp(ae,"ig").test(aj);
var an=new RegExp(ad,"ig").test(ap);
if(!an){an=new RegExp(ae,"ig").test(ap);
}if(ag.previousSibling&&ag.nextSibling&&!an){an=(ag.previousSibling.nodeName&&ag.nextSibling.nodeName)=="#text"?true:false;
}if(al){return !an;
}}}}return true;
}};
var E=null;
var M=function(R){return;
E=null;
if(R==null||R==undefined){return;
}var T=R;
var Z=T;
while(Z.nodeName!="BODY"){Z=Z.parentElement;
}var V=Z.childNodes;
var S=false;
var U=0;
var X=false;
for(var W=0;
W<V.length;
W++){if(X&&U==W+1){break;
}var Y=V[W];
if(Y.tagName){if(Y.uniqueID==T.uniqueID){U=W;
S=true;
if(V.length==W+1){W=0;
X=true;
}continue;
}if(S){if(C(Y)){E=Y;
break;
}}}if(W==V.length-1&&U!=0){X=true;
W=0;
}}};
var D=function(){return;
if(p(E,false)){E.scrollIntoView();
E.click();
l.selectElement(E);
}else{c.Dialogs.showAlert("Next trackchanges could not be found.","Resolve Track Changes",l.get_skin());
}};
var C=function(R){var S=b.CssClassNamePrefixFormat;
var T=Sys.UI.DomElement.containsCssClass;
var U=R.nodeName.toLowerCase();
return U=="ins"||U=="del"||T(R,S);
};
var O=function(S){var R=new Date().getTime();
while(new Date().getTime()<R+S){}};
var y=function(Z,ad,X,V,U){var T=typeof(U)!="undefined"?U:l;
try{var Y=T.get_keyDownEvent();
var aa=String.fromCharCode(Y.keyCode).match(/^\w+([\s-_]\w+)*$/i);
if(!aa){return false;
}}catch(S){}if(null==Z){Z="afterEnd";
}if(null==X){X="&nbsp";
}if(null==ad){ad="font";
}var ae=T._document.getElementById("vrtxInsertElement");
var R=Z=="afterEnd"?false:true;
if(!ae||ae==undefined){var ac=T.getSelectedElement();
ac.insertAdjacentHTML(Z,"<"+ad+' id="vrtxInsertElement">'+X+"</"+ad+">");
ae=T._document.getElementById("vrtxInsertElement");
}if(ae){try{ae.removeAttribute("id");
T.selectElement(ae);
if(V){if(R){var ab=T.getSelection().getRange();
var W=ab.findText(" ");
if(W){ab.select();
ab.collapse(false);
}}else{T.getSelection().collapse(R);
ae.innerHTML="";
}}else{T.getSelection().collapse(R);
}}catch(S){return false;
}}return true;
};
var j=function(S,R){var T=S;
var W={startOfElement:false,endOfElement:false,selectionStart:-1,selectionEnd:-1};
var V=c.TrackChangesUtils.getDomRange(R);
var X=V.cloneRange();
X.selectNodeContents(T);
X.snapToRange(c.DomRange.END_TO_END,V);
T.selectionStart=X.getText().length-V.getText().length;
T.selectionEnd=T.selectionStart+V.getText().length;
W.selectionStart=T.selectionStart;
W.selectionEnd=T.selectionEnd;
if(X.getText().length==0){W.startOfElement=true;
}var U=d.Editor.Utils.getTextContent(T)||"";
if(X.getText().length==U.length){W.endOfElement=true;
}return W;
};
var k=function(T,S){var R=typeof(S)!="undefined"?S:l;
if(typeof(T)=="undefined"||null==T){var V=document.selection.createRange();
if(V.length==1){return false;
}T=V.parentElement();
}if(T.nodeName.toLowerCase()=="font"&&T.className.match(b.CommentsRegex)){if(j(T,S).endOfElement){y("afterEnd","font","&nbsp;",true,S);
}}if(!R.getSelection().isControl()&&!R._canEditSelection()){if(T.nodeName.toLowerCase()=="ins"&&T.getAttribute(b.Attribute.Cite)){var U=j(T,S);
if(U.endOfElement){y("afterEnd","font","&nbsp;",true,S);
}else{if(U.startOfElement){y("beforeBegin","font","&nbsp;",true,S);
}}}}};
var f=function(T,W,R){var V=(typeof(W)!="undefined"&&W!=null)?W:l;
var S=new c.GenericCommand(T,V._contentWindow);
var U=V.get_commandsManager();
if(typeof(R)=="undefined"||R==null){R=true;
}U.execute(S,R);
};
var H=function(S,W){var V=(typeof(W)!="undefined"&&W!=null)?W:l;
var U=V.get_commandsManager();
var T=U.get_commands();
var R=T.length;
if(R>0){if(S==T[R-1]._title){U.removeCommandAt(R-1);
}}};
return{initialize:function(R){x(R);
},acceptAllChanges:function(){z=true;
o();
},acceptAllChangesSilently:function(){z=true;
l.setFocus();
try{N=true;
g();
}finally{N=false;
}},rejectAllChanges:function(){B=true;
o();
},rejectAllChangesSilently:function(){B=true;
l.setFocus();
try{N=true;
g();
}finally{N=false;
}},removeAllComments:function(){A=true;
o();
},moveToNextTrackChange:function(){D();
},setNextTrackChange:function(R){M(R);
},sleep:function(R){O(R);
},insertAdjacentElement:function(U,V,T,S,R){return y(U,V,T,S,R);
},checkElementEndPoint:function(S,R){return j(S,R);
},checkInsertionPoint:function(S,R){return k(S,R);
},addToStack:function(S,T,R){f(S,T,R);
},removeFromStack:function(R,S){H(R,S);
},setEditor:function(R){K(R);
}};
})();
})(Telerik.Web.UI,$telerik.$,Telerik.Web.UI.Editor,Telerik.Web.UI.Editor.TrackChangesConstants);
Type.registerNamespace("Telerik.Web.UI");
Type.registerNamespace("Telerik.Web.UI.Editor");
(function(e,a,c,d,b){d.EnableTrackChanges=function(g,h,f){h.set_enableTrackChanges(!h.get_enableTrackChanges());
var i=h.getToolByName("EnableTrackChanges");
i.setState(h.get_enableTrackChanges()?1:0);
};
d.EnableTrackChangesOverride=function(g,h,f){var i=h.getToolByName(g);
if(i){var j=h.get_enableTrackChangesOverride();
h.set_enableTrackChangesOverride(!j);
i.setOn(j);
}return true;
};
d.AcceptAllTrackChanges=function(g,h,f){Telerik.Web.UI.Editor.TrackChanges.setEditor(h);
Telerik.Web.UI.Editor.TrackChanges.acceptAllChanges();
return true;
};
d.RejectAllTrackChanges=function(g,h,f){Telerik.Web.UI.Editor.TrackChanges.setEditor(h);
Telerik.Web.UI.Editor.TrackChanges.rejectAllChanges();
return true;
};
d.RemoveAllComments=function(g,h,f){Telerik.Web.UI.Editor.TrackChanges.setEditor(h);
Telerik.Web.UI.Editor.TrackChanges.removeAllComments();
return true;
};
d.AddComment=d.AcceptTrackChange=d.RejectTrackChange=d.RemoveTrackChanges=d.RemoveComment=function(f,g,h){g.setActive();
g.executeTrackChangesCommand(f,false,null,null);
return true;
};
d.ImageManagerToDeleteCoveredBy=function(h,i,k){var g=function(n,m){i.pasteHtml(c.Utils.getOuterHtml(m.Result),h);
};
var j=i.get_dialogOpener().get_additionalQueryString();
var l=i.getSelectedElement();
if(l&&l.tagName.toLowerCase()=="img"){i.get_dialogOpener().set_additionalQueryString("&PreselectedItemUrl="+encodeURIComponent(l.src));
}var f={editor:i};
i.showDialog("ImageManager",f,g);
i.get_dialogOpener().set_additionalQueryString(j);
return false;
};
d._BrowserCommandOriginal=d.Bold;
d._FontBrowserCommandOriginal=d.ForeColor;
d.Bold=d.Italic=d.Underline=d.StrikeThrough=d.Subscript=d.Superscript=function(h,j,f){var v=typeof(f)=="undefined"?j.getToolByName(h):f._tool;
if(!j.get_enableTrackChanges()||j.get_enableTrackChangesOverride()){if(!j._canEditSelection()){alert(j.get_localization()["caneditselection"]);
return;
}var q=[];
var o="a";
var p=j.getSelection().getParentElement().getElementsByTagName(o);
for(var k=0;
k<p.length;
k++){var t=p[k];
if(t.contentEditable=="true"){q.push(t.innerHTML);
t.innerHTML="";
}}var m=j.getSelection().getParentElement();
if(m.tagName=="BODY"||m.tagName=="TABLE"||m.tagName=="TBODY"){if(!j.getSelection().isControl()){var w=j.getSelection().getRange();
var n=j.getSelection().getParentElement().getElementsByTagName("P");
var g=j.get_document().body;
for(var k=0;
k<n.length;
k++){var r=g.createTextRange();
r.moveToElementText(n[k]);
if(w.inRange(r)){n[k].style.textAlign="";
}}}}d._BrowserCommandOriginal(h,j,f);
if(q.length>0&&p.length<1){p=j.getSelection().getParentElement().getElementsByTagName(o);
}var l=0;
for(var k=0;
k<p.length;
k++){var t=p[k];
if(t.contentEditable=="true"){t.innerHTML=q[l];
l++;
}}}else{if(v._isOn){if(j._canEditSelection()){var u=new c.TrackChangesFormatCommand(h,j).formatTagCommandIndex(h).toLowerCase();
var s=c.TrackChangesUtils.enumerateNodesInRange(j.getSelection().getRange());
Array.forEach(s,function(i){if(i.tagName.toLowerCase()==u&&Sys.UI.DomElement.containsCssClass(i,b.CssClassNamePrefixFormat)){c.TrackChangesUtils.removeNodeTracking(i);
}});
d._BrowserCommandOriginal(h,j,f);
}else{alert(j.get_localization()["caneditselection"]);
}}else{j.executeFormatTrackChangesCommand(h);
}}return true;
};
c.CommandList._originalJustifyCommand=c.CommandList.JustifyFull;
c.CommandList.JustifyLeft=c.CommandList.JustifyRight=c.CommandList.JustifyCenter=c.CommandList.JustifyNone=c.CommandList.JustifyFull=function(g,h,f){if(h.shouldTrackChanges()){h.executeCommand(new c.TrackChangesJustifyFormatCommand(g,h));
h.raiseEvent("selectionChange",Sys.EventArgs.Empty);
}else{return c.CommandList._originalJustifyCommand.apply(this,arguments);
}return true;
};
c.CommandList._OriginalCut=c.CommandList.Cut;
c.CommandList.Cut=function(h,i,f){if(i.shouldTrackChanges()){var l=i.getSelection();
cutElem={htmlText:null,selectionType:null,element:null};
if(l.isControl()){var j=l.getParentElement();
cutElem.htmlText=$telerik.getOuterHtml(j);
cutElem.selectionType=c.SelectionType.Control;
}else{var k=new c.DomRange(l.getRange());
var g=k.getHtml().replace(new RegExp("<s*ins[^>]*>(.|\n)*?<s*/s*ins>","ig"),"");
cutElem.htmlText=g;
cutElem.selectionType=c.SelectionType.Range;
i._cachedRange=k.cloneRange();
}i.set_cutElement(cutElem);
}c.CommandList._OriginalCut(h,i,f);
if(!f||$telerik.isIE){if(i.shouldTrackChanges()){if(k){cloneRange=k.cloneRange();
var m=i.get_cutElement(cutElem);
k.collapse();
cloneRange.snapToRange(c.DomRange.START_TO_START,k);
Telerik.Web.UI.Editor.TrackChangesUtils.wrapCutElement(m.htmlText,i._reviewer,null,i,cloneRange);
i._cachedRange.select();
i._cachedRange=null;
}}}};
c.CommandList._OriginalInsertParagraph=c.CommandList.InsertParagraph;
c.CommandList.InsertParagraph=function(g,j,f){if(j.shouldTrackChanges&&j.shouldTrackChanges()){try{var m=c.TrackChangesUtils.getDomRange(j);
var h=j.getSelectedElement();
var l=h?h.previousSibling:null;
if(h&&l&&h.nodeName=="INS"&&l.nodeName=="DEL"){a("<br/>").insertAfter(h);
}else{m.extractContents();
var k=j.get_document().createElement("p");
k.innerHTML="<br/>";
m.insertNode(k);
m.selectNodeContents(k);
m.collapse(true);
m.select();
j.setFocus();
}return false;
}catch(i){j.removeFromStack("InsertParagraph");
}}c.CommandList._OriginalInsertParagraph(g,j,f);
};
d.InsertOrderedList=function(g,h,f){h.setFocus();
if(h.shouldTrackChanges()&&!confirm('Tracking Changes is not supported for lists.\n Click "OK" to continue, or "Cancel" to abort the operation.')){return;
}h.executeCommand(new c.InsertListCommand(h.getLocalizedString(g),h.get_contentWindow(),h.get_newLineMode()==Telerik.Web.UI.EditorNewLineModes.Br,g,h));
};
d.Indent=d.Outdent=function(g,h,f){if(!h.shouldTrackChanges()){d._BrowserCommandOriginal(g,h,f);
return;
}if(!h._canEditSelection()){alert(h.get_localization()["caneditselection"]);
return true;
}var p;
var m=h.getSelection();
var n=new c.DomRange(m.getRange()).getParentElement();
if(m.isControl()){h.executeBrowserCommand(g,true,null,null);
return;
}else{var j=function(q,r){return/^[\n\r\t]*$/.test(r.innerHTML);
};
var i=a("div, p",n).filter(j);
var l=a(n).parents("blockquote,ul").filter("blockquote,ul");
if(l.length==1&&g=="Outdent"&&!c.TrackChangesUtils.isTrackChangeElement(l[0])){p=c.Utils.replaceNode(l[0],"div");
}else{h.executeBrowserCommand(g,false,null,null);
}var o=c.TrackChangesUtils.getDomRange(h).getParentElement();
if(!o){return false;
}a("div, p",o).filter(j).not(i).remove();
if(!p){var k=a(o).parents("blockquote,ul").filter("blockquote,ul").not(l);
if(k.length){p=k.last()[0];
}else{c.TrackChangesUtils.removeNodeTracking(o);
return false;
}}h.setForamtTrackChangesAttributes(p,g);
if($telerik.isSafari){a(p).css({border:"",borderWidth:"",borderColor:"",borderImage:"",margin:"",padding:""});
}h.raiseEvent("selectionChange",Sys.EventArgs.Empty);
return true;
}};
d.InsertTable=function(g,h,f){var k=f.value;
if(k){var i=c.Utils.createTable(k.rows,k.cols);
var j=Telerik.Web.UI.Editor.Utils.getOuterHtml(i);
h.pasteHtml(j,g);
}};
d.InsertRowAbove=d.InsertRowBelow=function(h,i,f){var g=new c.TableInsertRow(i.getLocalizedString(h),null,h=="InsertRowAbove"?"above":"below");
g._editor=i;
i.executeCommand(g);
};
d.DeleteRow=function(h,i,f){var g=new c.TableDeleteRow(i.getLocalizedString(h));
g._editor=i;
i.executeCommand(g);
};
d.InsertColumnLeft=d.InsertColumnRight=function(h,i,f){var g=new c.TableInsertColumn(i.getLocalizedString(h),null,h=="InsertColumnLeft"?"left":"right");
g._editor=i;
i.executeCommand(g);
};
})(Telerik.Web.UI,$telerik.$,Telerik.Web.UI.Editor,Telerik.Web.UI.Editor.CommandList,Telerik.Web.UI.Editor.TrackChangesConstants);
Type.registerNamespace("Telerik.Web.UI.Editor");
Type.registerNamespace("Telerik.Web.UI.Editor.TrackChangesCommands");
(function(c,a,d,b){Telerik.Web.UI.Editor.TrackChangesCommand=function(g,e){var f=e._contentWindow;
Telerik.Web.UI.Editor.TrackChangesCommand.initializeBase(this,[(g||"Track Change Command"),f,true]);
this._editor=e;
};
Telerik.Web.UI.Editor.TrackChangesCommand.prototype={getState:function(k){try{k=k||this.get_window();
var g=k.document;
if(null==g){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}var h=new Telerik.Web.UI.Editor.Selection(k);
var m=h.getParentElement();
if(this._editor.get_enableTrackChanges()&&m){var o=this._editor.getToolByName("Underline");
var n=this._editor.getToolByName("StrikeThrough");
if(o){o.setOn(m.tagName=="INS"?0:o.isOn());
o.setOn(m.parentElement.tagName=="INS"?$telerik.getOuterHtml(m).indexOf(b.Attribute.BrowserCommand+'="Underline"')>-1:o.isOn());
o.setOn(m.parentElement.parentElement&&m.parentElement.parentElement.tagName=="INS"?$telerik.getOuterHtml(m.parentElement).indexOf(b.Attribute.BrowserCommand+'="Underline"')>-1:o.isOn());
}if(n){n.setOn(m.tagName=="DEL"?0:n.isOn());
n.setOn(m.parentElement.tagName=="DEL"?$telerik.getOuterHtml(m).indexOf('browserCommand="StrikeThrough"')>-1:n.isOn());
n.setOn(m.parentElement.parentElement&&m.parentElement.parentElement.tagName=="DEL"?$telerik.getOuterHtml(m.parentElement).indexOf(b.Attribute.BrowserCommand+'="StrikeThrough"')>-1:n.isOn());
}}var l=Telerik.Web.UI.Editor.TrackChangesUtils.findTrackChangesParentElement(m,this._editor);
if(null!=l&&(l.User==this._editor.get_reviewer()||this._editor.get_isAuthor())){var f=l.HtmlElement.nodeName=="FONT"&&l.HtmlElement.className.match(b.CommentsRegex);
if(!this._editor.get_enableTrackChanges()){if(this._title=="Reject Track Changes"||this._title=="Accept Track Changes"){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}else{return Telerik.Web.UI.Editor.CommandStates.Off;
}}if(this._title=="Accept Track Changes"){if(!this._editor.get_canAcceptTrackChanges()||f){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}}if(this._title=="Reject Track Changes"){if(!this._editor.get_canAcceptTrackChanges()||f){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}}return Telerik.Web.UI.Editor.CommandStates.Off;
}else{if(this._title.toLowerCase().indexOf(" all track changes")!=-1||this._title.toLowerCase().indexOf(" all comments")!=-1){return Telerik.Web.UI.Editor.CommandStates.Off;
}else{return Telerik.Web.UI.Editor.CommandStates.Disabled;
}}}catch(e){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}}};
Telerik.Web.UI.Editor.TrackChangesCommand.registerClass("Telerik.Web.UI.Editor.TrackChangesCommand",Telerik.Web.UI.Editor.CommandBase);
d.AcceptTrackChanges=function(g,f,e){d.AcceptTrackChanges.initializeBase(this,[(g||"Accept Track Changes"),f]);
};
d.AcceptTrackChanges.prototype={OnExecuteIE:function(){if(this.getState(this._editor.get_contentWindow())==Telerik.Web.UI.Editor.CommandStates.Disabled){return;
}var n=this._editor.getSelectedElement();
var m=Telerik.Web.UI.Editor.TrackChangesUtils.findTrackChangesParentElement(n,this._editor);
if(!m){return false;
}var e=Telerik.Web.UI.Editor.TrackChangesElementType;
var h=m.HtmlElement;
if(m.Type==e.Delete){var g=Telerik.Web.UI.Editor.TrackChangesSelection.getSimilarElements(h,"name");
for(var k=0;
k<g.length;
k++){var f=g[k];
f.parentNode.removeChild(f);
}}else{if(m.Type==e.Comment||m.Type==e.Insert){c.Editor.Utils.removeNode(h);
}else{var l="";
var p=Telerik.Web.UI.Editor.TrackChangesSelection.locateElementInRange(this._editor.getSelection().getRange(),"table");
if(p.inRange){var o=h.className.split(" ");
if(o.length==2){l=o[1];
}}h.removeAttribute(b.Attribute.Author);
h.removeAttribute(b.Attribute.BrowserCommand);
h.className=l;
h.removeAttribute("alignOrig");
h.removeAttribute(b.Attribute.Timestamp);
h.removeAttribute(b.Attribute.Title);
}}return true;
},OnExecuteMoz:function(){return this.OnExecuteIE();
}};
d.AcceptTrackChanges.registerClass("Telerik.Web.UI.Editor.TrackChangesCommands.AcceptTrackChanges",c.Editor.TrackChangesCommand);
d.RejectTrackChanges=function(g,f,e){d.RejectTrackChanges.initializeBase(this,[(g||"Reject Track Changes"),f]);
};
d.RejectTrackChanges.prototype={OnExecuteIE:function(){if(this.getState(this._editor.get_contentWindow())==Telerik.Web.UI.Editor.CommandStates.Disabled){return;
}var o=this._editor.getSelectedElement();
var n=Telerik.Web.UI.Editor.TrackChangesUtils.findTrackChangesParentElementForReject(o);
if(!n){return false;
}var h=n.HtmlElement;
var m=h.parentElement;
if(n.Type==Telerik.Web.UI.Editor.TrackChangesElementType.Insert){m.removeChild(h);
return true;
}if(n.Type==Telerik.Web.UI.Editor.TrackChangesElementType.FormatChange){var f=h.getAttribute(b.Attribute.BrowserCommand);
h.removeAttribute(b.Attribute.Title);
var l="";
var r=Telerik.Web.UI.Editor.TrackChangesSelection.locateElementInRange(this._editor.getSelection().getRange(),"table");
if(r.inRange){var p=h.className.split(" ");
if(p.length==2){l=p[1];
}}if(f.indexOf("Justify")==0){h.removeAttribute(b.Attribute.Author);
h.removeAttribute(b.Attribute.BrowserCommand);
h.removeAttribute(b.Attribute.Timestamp);
h.className=l;
var q=h.style;
var e=h.getAttribute("alignOrig");
if(e){if(e!="none"){h.setAttribute("align",e);
q.textAlign=e;
}else{h.removeAttribute("align");
q.textAlign="";
}h.removeAttribute("alignOrig");
}return true;
}else{if(f.indexOf("Outdent")==0){c.Editor.Utils.trimWhitespaceTextNodes(h);
h.removeAttribute(b.Attribute.Author);
h.removeAttribute(b.Attribute.BrowserCommand);
h.removeAttribute(b.Attribute.Timestamp);
h.className=l;
if(h.tagName.toLowerCase()=="div"){c.Editor.Utils.removeNode(h);
}this._editor._document.execCommand("Indent",false,null);
return true;
}}}if(h.nodeName=="DEL"){var g=Telerik.Web.UI.Editor.TrackChangesSelection.getSimilarElements(h,"name");
if(g.length<2){c.Editor.Utils.removeNode(h);
}else{for(var k=0;
k<g.length;
k++){h=g[k];
c.Editor.Utils.removeNode(h);
}}}else{c.Editor.Utils.removeNode(h);
}return true;
},OnExecuteMoz:function(){return this.OnExecuteIE();
}};
d.RejectTrackChanges.registerClass("Telerik.Web.UI.Editor.TrackChangesCommands.RejectTrackChanges",c.Editor.TrackChangesCommand);
d.RemoveTrackChanges=function(g,f,e){d.RemoveTrackChanges.initializeBase(this,[(g||"Remove Track Changes"),f]);
};
d.RemoveTrackChanges.prototype={onExecute:function(f,g,e){var l=this._editor.getSelectedElement(),h=c.Editor.TrackChangesUtils.findTrackChangesParentElement(l,this._editor);
if(h&&h.Type==c.Editor.TrackChangesElementType.Comment){c.Editor.Utils.removeNode(h.HtmlElement);
return true;
}else{var k=new c.Editor.TrackChangesCommands.RejectTrackChanges("RejectTrackChanges",this._editor,"RejectTrackChanges");
return k.OnExecuteIE("RejectTrackChanges",this._editor,null);
}return false;
}};
d.RemoveTrackChanges.registerClass("Telerik.Web.UI.Editor.TrackChangesCommands.RemoveTrackChanges",c.Editor.TrackChangesCommand);
d.AddComment=function(g,f,e){d.AddComment.initializeBase(this,[(g||"Add Comment"),f]);
};
d.AddComment.prototype={getState:function(h){if(!h){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}var l=new Telerik.Web.UI.Editor.Selection(h);
if(!l||l.getHtml()==""){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}var e=Telerik.Web.UI.Editor.TrackChangesSelection.locateElementInRange(l.getRange(),"comment");
if(e.inRange){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}try{h=h||this.get_window();
var g=h.document;
if(null==g){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}var k=Telerik.Web.UI.Editor.TrackChangesUtils.findTrackChangesParentElement(l.getParentElement(),this._editor);
if(k&&k.Type==Telerik.Web.UI.Editor.TrackChangesElementType.Comment){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}else{return Telerik.Web.UI.Editor.CommandStates.Off;
}}catch(f){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}},OnExecuteIE:function(){try{var u=this._editor.getSelection();
if(u.isControl()){Telerik.Web.UI.Editor.TrackChangesUtils.wrapElementInTrackChanageComment(element=u.getParentElement(),b.CssClassComment,this._editor._reviewer);
return;
}var q=this._editor.getSelection().getRange();
var p=true;
var n=Telerik.Web.UI.Editor.TrackChangesSelection.locateElementInRange(q,"img");
if(n.partialOverlapped||n.fullySelected){p=false;
}var r=this._editor.getSelectedElement();
if(r&&r.nodeName=="A"){Telerik.Web.UI.Editor.TrackChangesSelection.wrapElement(r,this._editor);
}var f=false;
if(p){var v=q.text;
q.findText(v);
q.select();
if(q.parentElement()&&(q.parentElement().className=="MsoCaption"||q.parentElement().className=="Caption")){f=true;
q.moveToElementText(q.parentElement().children[0]);
q.select();
}}var w=document.createElement("DIV");
w.innerHTML=q.htmlText;
if(q.textHtml==""){alert("Please, select some text you want to comment on.");
return;
}var s=q.parentElement();
var t=s.nodeName=="P"?true:false;
var m="</?(u|strong|em|strike|sup|sub)[^>]*/?>";
if(q.htmlText.match(new RegExp(m,"i"))){t=true;
var l=s.firstChild;
var o=s.lastChild;
if(l&&o){if(l.nodeName=="#text"&&o.nodeName=="#text"){if(l.nodeValue==o.nodeValue){t=false;
}}}}var x=q.htmlText;
if(w.childNodes.length==1&&w.childNodes[0].nodeName!="#text"&&p){x=w.childNodes[0].innerHTML;
w.childNodes[0].innerHTML="<"+b.TagComment+" id='"+this._editor.get_commentID()+"' class='"+b.CssClassComment+"' "+b.Attribute.Author+"='"+this._editor._reviewer+"' "+b.Attribute.Comment+"='' "+b.Attribute.Title+"='#empty comment#' "+b.Attribute.Timestamp+"='"+new Date().getTime()+"'>"+x+"</"+b.TagComment+">";
x=w.childNodes[0].innerHTML;
}else{x="<"+b.TagComment+" id='"+this._editor.get_commentID()+"' class='"+b.CssClassComment+"' "+b.Attribute.Author+"='"+this._editor._reviewer+"' "+b.Attribute.Comment+"='' "+b.Attribute.Title+"='#empty comment#' "+b.Attribute.Timestamp+"='"+new Date().getTime()+"'>"+x+"</"+b.TagComment+">";
}if($telerik.isIE9Mode){var h=s;
var g=h.firstChild;
while(!c.Editor.Utils.isEditorContentArea(h)&&(g.nodeType!=3||g.nodeValue.indexOf("\t")==-1)){h=h.parentNode;
g=h.firstChild;
}if(g.nodeType==3){g.nodeValue=g.nodeValue.replace(/\t+$/g,"");
}}if(t||f){q.pasteHTML("");
q.pasteHTML(x);
q.moveStart("character",-1);
q.select();
}else{q.pasteHTML(x);
}tmpChild=null;
w=null;
return true;
}catch(k){return false;
}},OnExecuteMoz:function(){try{var g=this._editor.get_contentWindow().document;
var f=g.createElement(b.TagComment);
f.id=this._editor.get_commentID();
f.className=b.CssClassComment;
f.setAttribute(b.Attribute.Author,this._editor._reviewer);
f.setAttribute(b.Attribute.Comment,"");
f.setAttribute(b.Attribute.Title,"#empty comment#");
f.setAttribute(b.Attribute.Timestamp,new Date().getTime());
var k=new Telerik.Web.UI.Editor.DomRange(this._editor.getSelection().getRange());
k.surroundContents(f);
k.selectNodeContents(f);
k.select();
return true;
}catch(h){return false;
}}};
d.AddComment.registerClass("Telerik.Web.UI.Editor.TrackChangesCommands.AddComment",c.Editor.TrackChangesCommand);
d.EnableTrackChanges=function(g,f,e){d.EnableTrackChanges.initializeBase(this,[(g||"Add Comment"),f]);
};
d.EnableTrackChanges.prototype={getState:function(f){try{if(this._editor.get_enableTrackChanges()){return Telerik.Web.UI.Editor.CommandStates.On;
}else{return Telerik.Web.UI.Editor.CommandStates.Off;
}}catch(e){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}},OnExecuteIE:function(){this._editor.set_enableTrackChanges(!this._editor.get_enableTrackChanges());
editor.raiseEvent("selectionChange",Sys.EventArgs.Empty);
return false;
}};
Telerik.Web.UI.Editor.TrackChangesCommands.EnableTrackChanges.registerClass("Telerik.Web.UI.Editor.TrackChangesCommands.EnableTrackChanges",Telerik.Web.UI.Editor.TrackChangesCommand);
d.EnableTrackChangesOverride=function(g,f,e){d.EnableTrackChangesOverride.initializeBase(this,[(g||"Enable Track Changes override"),f]);
};
d.EnableTrackChangesOverride.prototype={getState:function(f){try{if(this._editor.get_enableTrackChangesOverride()){return Telerik.Web.UI.Editor.CommandStates.Off;
}else{return Telerik.Web.UI.Editor.CommandStates.On;
}}catch(e){return Telerik.Web.UI.Editor.CommandStates.Disabled;
}},OnExecuteIE:function(){this._editor.set_enableTrackChangesOverride(!this._editor.get_enableTrackChangesOverride());
editor.raiseEvent("selectionChange",Sys.EventArgs.Empty);
return false;
},OnExecuteMoz:function(){return this.OnExecuteIE();
}};
Telerik.Web.UI.Editor.TrackChangesCommands.EnableTrackChangesOverride.registerClass("Telerik.Web.UI.Editor.TrackChangesCommands.EnableTrackChangesOverride",Telerik.Web.UI.Editor.TrackChangesCommand);
Telerik.Web.UI.Editor.TrackChangesFormatCommand=function(f,e){this.editor=e;
this.commandName=f;
Telerik.Web.UI.Editor.TrackChangesFormatCommand.initializeBase(this,["Format Track Change "+f,e.get_contentWindow(),true]);
};
Telerik.Web.UI.Editor.TrackChangesFormatCommand.prototype={OnExecuteIE:function(){return this.OnExecuteMoz();
},OnExecuteMoz:function(){var m=this.formatTagCommandIndex(this.commandName);
var l=Telerik.Web.UI.Editor.TrackChangesUtils.markEditorSelection(this.editor);
var e=l.newElements;
var k=[];
for(var g=0;
g<e.length;
g++){var h=e[g];
if(!this.isChildOfSameElementType(h,m)){var f=h.getAttribute("face");
h=this.replaceTag(h,m);
this.editor.setForamtTrackChangesAttributes(h,this.commandName);
this.flattenElementByTagAuthor(h);
(!h.getAttribute("face"));
h.style.fontFamily=f;
k.push(h);
}else{this.stripNode(h);
}}this.removeEmptyNodes(k);
this.selectNodes(k);
return true;
},selectNodes:function(e){if(e.length==0){return;
}var f=c.Editor.TrackChangesUtils.getDomRange(this.editor);
if(e.length==1){f.selectNodeContents(e[0]);
}else{f.setStart(e[0],0);
f.setEnd(e[e.length-1],1);
}f.select();
},removeEmptyNodes:function(g){for(var f=0;
f<g.length;
f++){var e=g[f];
if(c.Editor.Utils.isNodeEmpty(e)){a(e).remove();
}}},formatTagCommandIndex:function(f){var e=f;
switch(e){case"Bold":return"B";
case"Italic":return"I";
case"Underline":return"U";
case"StrikeThrough":return"STRIKE";
case"Subscript":return"SUB";
case"Superscript":return"SUP";
}},isChildOfSameElementType:function(g,h){var e=g.parentNode;
var f=e.tagName.toUpperCase();
while(e!=null&&f!="BODY"){if(e.tagName.toUpperCase()==h){return e;
}e=e.parentNode;
f=e.tagName.toUpperCase();
}return null;
},flattenElementByTagAuthor:function(h){var f=h.getElementsByTagName(h.tagName);
var e=h.getAttribute(b.Attribute.Author);
var k=[];
for(var g=0;
g<f.length;
g++){if(f[g].getAttribute(b.Attribute.Author)==e){k.push(f[g]);
}}for(var g=0;
g<k.length;
g++){this.stripNode(k[g]);
}},replaceTag:function(f,k){var e=f.innerHTML;
var h=f.ownerDocument.createElement(k);
if(f.replaceNode){f.replaceNode(h);
}else{var g=f.parentNode;
g.insertBefore(h,f);
g.removeChild(f);
}h.innerHTML=e.replace(/^\s+/ig,"&nbsp;");
return h;
},stripNode:function(e){c.Editor.Utils.removeNode(e);
},getUserFormatingTrackChanges:function(h){var k=[];
var f=$telerik.isSafari?"span":"font";
var e=h.getElementsByTagName(f);
for(var g=0;
g<e.length;
g++){if(e[g].getAttribute(b.Attribute.Author)==this.editor._reviewer){k.push(e[g]);
}}return k;
}};
Telerik.Web.UI.Editor.TrackChangesFormatCommand.registerClass("Telerik.Web.UI.Editor.TrackChangesFormatCommand",Telerik.Web.UI.Editor.CommandBase);
Telerik.Web.UI.Editor.TrackChangesJustifyFormatCommand=function(f,e){this.editor=e;
this.commandName=f;
Telerik.Web.UI.Editor.TrackChangesJustifyFormatCommand.initializeBase(this,["Format Track Change "+f,e.get_contentWindow(),true]);
};
Telerik.Web.UI.Editor.TrackChangesJustifyFormatCommand.prototype={OnExecuteIE:function(){var v=this.editor.getSelection();
var o=false;
var p=false;
var n=false;
var q=v.GetParentElement();
if(v.isControl()){if(q.tagName=="IMG"){n=true;
if(q.parentElement.tagName!="P"||(q.parentElement.tagName=="P"&&q.parentElement.childNodes.length>1)){o=true;
this.editor.executeBrowserCommand(this.commandName,true,null,null);
}}else{if(q.tagName=="TABLE"){p=true;
}else{return;
}}}var w;
if(n){w=v.GetParentElement().parentElement;
}else{w=v.getParentElement();
}var m,l;
var h="";
var u="";
if(p){if(q.getAttribute("alignOrig")){u=q.getAttribute("alignOrig");
}else{u=q.getAttribute("align");
}}else{if(w.getAttribute("alignOrig")){u=w.getAttribute("alignOrig");
}else{u=o?"":w.getAttribute("align");
}}switch(this.commandName.toLowerCase()){case"justifyleft":h="left";
break;
case"justifyright":h="right";
break;
case"justifycenter":h="center";
break;
case"justifyfull":h="justify";
break;
}if(!v.isControl()&&!n){this.editor._cachedRange=c.Editor.TrackChangesUtils.getDomRange(this.editor).cloneRange();
m=this.enumerateNodesInRange(h);
if(this.editor._cachedRange){this.editor._cachedRange.select();
this.editor._cachedRange=null;
}}if(!w){return false;
}if(!v.isControl()&&!n){var s=this.getParentParagraphHeadingTag(w);
var t=false;
if(m.length==0){if(s&&(s.tagName=="P"||s.tagName=="H1"||s.tagName=="H2"||s.tagName=="H3"||s.tagName=="H4"||s.tagName=="H5"||s.tagName=="H6")){t=true;
}if(t){if(s.getAttribute("alignOrig")){u=s.getAttribute("alignOrig");
}else{u=s.getAttribute("align")?s.getAttribute("align"):"";
}}}this.editor._document.execCommand(this.commandName,false,null);
l=this.enumerateNodesInRange(h);
var k,e="",f="";
for(i=0;
i<l.length;
i++){k=true;
for(j=0;
j<m.length;
j++){if(m[j]==l[i]){e=m[j].getAttribute("align");
f=l[i].getAttribute("align");
k=e!=f;
break;
}}if(k){this.editor.setJustifyForamtTrackChangesAttributes(l[i],this.commandName,u,h);
}}if(l.length==0){if(!t){s=this.getParentParagraphHeadingTag(w);
if(s&&(s.tagName=="P"||s.tagName=="H1"||s.tagName=="H2"||s.tagName=="H3"||s.tagName=="H4"||s.tagName=="H5"||s.tagName=="H6")){t=true;
u="";
}}if(t){s=this.getParentParagraphHeadingTag(w);
this.editor.setJustifyForamtTrackChangesAttributes(s,this.commandName,u,h);
}}}else{if(p||n){var r,g;
if(p){r=q.getAttribute("align");
this.editor.executeBrowserCommand(this.commandName,true,null,null);
g=q.getAttribute("align");
}else{s=this.getParentParagraphHeadingTag(v.getParentElement());
r=o?"":s.getAttribute("align");
this.editor.executeBrowserCommand(this.commandName,true,null,null);
s=this.getParentParagraphHeadingTag(v.getParentElement());
g=s.getAttribute("align");
q=s;
}if(r!=g){this.editor.setJustifyForamtTrackChangesAttributes(q,this.commandName,u,h);
}}else{this.editor.executeBrowserCommand(this.commandName,true,null,null);
return;
}}this.editor.raiseEvent("selectionChange",Sys.EventArgs.Empty);
return true;
},OnExecuteMoz:function(){var v=this.editor.getSelection();
var u=new c.Editor.DomRange(v.getRange());
var n=false;
var o=false;
var m=false;
var p=u.getParentElement();
if(v.isControl()){if(p.tagName=="IMG"){m=true;
if(p.parentElement.tagName!="P"||(p.parentElement.tagName=="P"&&p.parentElement.childNodes.length>1)){n=true;
this.editor.executeBrowserCommand(this.commandName,true,null,null);
}}else{if(p.tagName=="TABLE"){o=true;
}else{return;
}}}var w=c.Editor.Utils.getFirstBlockElementUp(u.getParentElement());
if(m){w=w.parentElement;
}var l,k;
var g="";
var t="";
if(o){t=this.getPreviousAlign(p);
}else{t=w.getAttribute("alignOrig")||(n?"":this.getAlign(w));
}switch(this.commandName.toLowerCase()){case"justifyleft":g="left";
break;
case"justifyright":g="right";
break;
case"justifycenter":g="center";
break;
case"justifyfull":g="justify";
break;
}if(!v.isControl()&&!m){var e=new c.Editor.DomRange(this.editor.getSelection().getRange()).cloneRange();
l=this.enumerateNodesInRange(g);
if(e){e.select();
}}if(!w){return false;
}if(!v.isControl()&&!m){var r=this.getParentParagraphHeadingTag(w);
var s=false;
if(l.length==0){if(r&&(r.tagName=="P"||r.tagName=="H1"||r.tagName=="H2"||r.tagName=="H3"||r.tagName=="H4"||r.tagName=="H5"||r.tagName=="H6")){s=true;
}if(s){t=this.getPreviousAlign(r);
}}c.Editor.CommandList._originalJustifyCommand(this.commandName,this.editor);
k=this.enumerateNodesInRange(g);
var h;
for(i=0;
i<k.length;
i++){h=true;
for(j=0;
j<l.length;
j++){if(l[j]==k[i]){h=this.getAlign(l[j])!=this.getAlign(k[i]);
break;
}}if(h){this.editor.setJustifyForamtTrackChangesAttributes(k[i],this.commandName,t,g);
}}if(k.length==0){if(!s){r=this.getParentParagraphHeadingTag(w);
if(r&&(r.tagName=="P"||r.tagName=="H1"||r.tagName=="H2"||r.tagName=="H3"||r.tagName=="H4"||r.tagName=="H5"||r.tagName=="H6")){s=true;
t="";
}}if(s){r=this.getParentParagraphHeadingTag(w);
this.editor.setJustifyForamtTrackChangesAttributes(r,this.commandName,t,g);
}}}else{if(o||m){var q,f;
if(o){q=this.getAlign(p);
this.editor.executeBrowserCommand(this.commandName,true,null,null);
f=this.getAlign(p);
}else{r=this.getParentParagraphHeadingTag(u.getParentElement());
q=n?"":this.getAlign(p);
c.Editor.CommandList._originalJustifyCommand(this.commandName,this.editor);
r=this.getParentParagraphHeadingTag(u.getParentElement());
f=this.getAlign(p);
p=r;
}if(q!=f){this.editor.setJustifyForamtTrackChangesAttributes(p,this.commandName,t,g);
}}else{c.Editor.CommandList._originalJustifyCommand(this.commandName,this.editor);
return;
}}this.editor.raiseEvent("selectionChange",Sys.EventArgs.Empty);
return true;
},getParentParagraphHeadingTag:function(e){while(e.tagName!="P"&&e.tagName!="H1"&&e.tagName!="H2"&&e.tagName!="H3"&&e.tagName!="H4"&&e.tagName!="H5"&&e.tagName!="H6"&&e.tagName!="BODY"&&e.tagName!=null){e=e.parentElement;
}return e;
},enumerateNodesInRange:function(e){var l=[];
var m=this.editor.getSelection();
var h=new c.Editor.DomRange(m.getRange());
var n=c.Editor.Utils.getFirstBlockElementUp(h.getParentElement());
if(n==null){return l;
}var k=h.cloneRange();
k.selectNodeContents(n);
if(!(n.tagName.toLowerCase()=="body")&&this.intersect(k,h)&&this.getAlign(n)==e){l.push(n);
}for(var g=0;
g<n.children.length;
g++){var f=n.children[g];
if(!f.innerHTML){continue;
}k.selectNodeContents(f);
if(this.intersect(k,h)&&(this.getAlign(f)==e)){l.push(f);
}}h.select();
return l;
},intersect:function(e,f){return !((e.compareBoundaryPoints(c.Editor.DomRange.START_TO_START,f)==-1&&e.compareBoundaryPoints(c.Editor.DomRange.START_TO_END,f)==-1)||(e.compareBoundaryPoints(c.Editor.DomRange.END_TO_START,f)==1&&e.compareBoundaryPoints(c.Editor.DomRange.END_TO_END,f)==1));
},getPreviousAlign:function(e){return e.getAttribute("alignOrig")||this.getAlign(e);
},getAlign:function(e){return e.tagName&&(e.style.textAlign||e.getAttribute("align"))||"";
}};
Telerik.Web.UI.Editor.TrackChangesJustifyFormatCommand.registerClass("Telerik.Web.UI.Editor.TrackChangesJustifyFormatCommand",Telerik.Web.UI.Editor.CommandBase);
Telerik.Web.UI.Editor.TrackChangesIndentOutdentFormatCommand=function(f,e){this.editor=e;
this.commandName=f;
Telerik.Web.UI.Editor.TrackChangesIndentOutdentFormatCommand.initializeBase(this,["Format Track Change "+f,e.get_contentWindow(),true]);
};
Telerik.Web.UI.Editor.TrackChangesIndentOutdentFormatCommand.prototype={OnExecuteIE:function(){var e=this.editor.getSelection();
if(e.isControl()){this.editor.executeBrowserCommand(this.commandName,true,null,null);
return;
}this.editor._document.execCommand(this.commandName,false,null);
var f=this.editor.getSelection();
var g=f.getParentElement();
if(!g){return false;
}if(this.commandName.indexOf("Outdent")==0){trackEl=this._findOutdentElement(g);
if(trackEl==null){return false;
}}else{trackEl=this._findIndentElement(g);
if(trackEl==null){return false;
}}this.editor.setForamtTrackChangesAttributes(trackEl,this.commandName);
this.editor.raiseEvent("selectionChange",Sys.EventArgs.Empty);
return true;
},_findIndentElement:function(f){var e=f;
var g=e.tagName.toLowerCase();
while(e&&g!="body"){if(g=="blockquote"||g=="ul"){return e;
}e=e.parentNode;
g=e.tagName.toLowerCase();
}return null;
},_findOutdentElement:function(f){var e=f;
var g=e.tagName.toLowerCase();
while(e&&g!="body"){if(g=="div"||g=="p"||g=="li"){return e;
}e=e.parentNode;
g=e.tagName.toLowerCase();
}return null;
}};
Telerik.Web.UI.Editor.TrackChangesIndentOutdentFormatCommand.registerClass("Telerik.Web.UI.Editor.TrackChangesIndentOutdentFormatCommand",Telerik.Web.UI.Editor.CommandBase);
})(Telerik.Web.UI,$telerik.$,Telerik.Web.UI.Editor.TrackChangesCommands,Telerik.Web.UI.Editor.TrackChangesConstants);
Type.registerNamespace("Telerik.Web.UI.Editor");
(function(d,a,c,b){c.TrackChangesSelection=(function(){var t=function(y,D,x,z){y=c.DomRange.toDomRange(y);
var A={fullySelected:false,textSelected:false,partialStart:false,partialEnd:false,partialOverlapped:false,overlapped:false,inRange:false,rangeType:"",errorMsg:""};
if(y.range.length){return A;
}var w=(typeof(D)=="undefined"||null==D)?"":D;
var v=(typeof(z)=="undefined"||null==z)?k(D):z;
var u=(typeof(x)=="undefined"||null==x)?true:x;
if(w==""){A.errorMsg="Tag Name is required.";
}if(!y){A.errorMsg="No selection found.";
}if(A.errorMsg==""){var B=y.getParentElement();
var C=y.cloneRange();
if(C.range.length){if(D.match(/(placeholder|caption)/i)){if(new RegExp(v,"i").test($telerik.getOuterHtml(B))){B=B.parentElement;
}}if(new RegExp(v,"i").test($telerik.getOuterHtml(B))){A.fullySelected=true;
}if(!A.fullySelected){if(new RegExp(v,"i").test($telerik.getOuterHtml(B.parentElement))&&B.parentElement.nodeName.match(/(ins|del)/i)){A.fullySelected=true;
}}A.rangeType="Selectable";
}else{if(n(C,w,u,v)){A.fullySelected=true;
}else{if(s(C,w,u,v)){A.textSelected=true;
}else{if(r(C,w,u,v)){A.partialStart=true;
A.textSelected=true;
}else{if(p(C,w,u,v)){A.partialEnd=true;
A.textSelected=true;
}else{if(q(C,w,u,v)){A.partialOverlapped=true;
}else{if(o(C,w,u,v)){A.overlapped=true;
}else{}}}}}}A.rangeType="Range";
}}if(A.fullySelected||A.overlapped||A.partialEnd||A.partialOverlapped||A.partialStart||(A.textSelected&&!D)){A.inRange=true;
}return A;
};
var k=function(v){var u="";
if(typeof(v)=="undefined"||!v){return"";
}switch(v.toLowerCase()){case"img":u="</?(IMG).*\n*src=.*[^>]*/?>";
break;
case"a":u="</?(a).*\n*href=.*[^>]*/?>";
break;
case"ins":u="(</?(ins)[^>]*("+b.Attribute.Author+"|"+b.Attribute.Cite+")=?)";
break;
case"del":u="(</?(del)[^>]*("+b.Attribute.Author+"|"+b.Attribute.Cite+")=?)";
break;
case"comment":u="</?(font).*\n*class=.*"+b.CssClassNamePrefixComment+".*\n*[^>]*/?>";
break;
case"trackchange_strong":u="(</?(strong)[^>]*("+b.Attribute.Author+"|"+b.Attribute.Cite+")=?)";
break;
case"trackchange_em":u="(</?(em)[^>]*("+b.Attribute.Author+"|"+b.Attribute.Cite+")=?)";
break;
case"trackchange_u":u="(</?(u)[^>]*("+b.Attribute.Author+"|"+b.Attribute.Cite+")=?)";
break;
case"trackchange_strike":u="(</?(strike)[^>]*("+b.Attribute.Author+"|"+b.Attribute.Cite+")=?)";
break;
case"trackchange_sup":u="(</?(sup)[^>]*("+b.Attribute.Author+"|"+b.Attribute.Cite+")=?)";
break;
case"trackchange_sub":u="(</?(sub)[^>]*("+b.Attribute.Author+"|"+b.Attribute.Cite+")=?)";
break;
case"trackchange_p":u="(</?(p)[^>]*("+b.Attribute.Author+"|"+b.Attribute.Cite+"=?)";
break;
case"table":u="</?(table)[^>]*/?>";
break;
case"bookmark":u='</?(a).*\n*class="?[^"]*?bookmarkDisplayTool[^"]*?"?[^>]*/?>';
break;
case"placeholder":u="(</?(span|font)[^>]*(name)s*=s*?('|\")+(_wp)+.*)";
break;
case"caption":u="(</?(span|font)[^>]*(name)s*=s*?('|\")+(forCaption)+.*?>)";
break;
default:break;
}return u;
};
var m=function(w){var u=w.toUpperCase();
var v=u;
switch(u){case"COMMENT":v="FONT";
break;
case"TRACKCHANGE_STRONG":v="STRONG";
break;
case"TRACKCHANGE_EM":v="EM";
break;
case"TRACKCHANGE_U":v="U";
break;
case"TRACKCHANGE_STRIKE":v="STRIKE";
break;
case"TRACKCHANGE_SUP":v="SUP";
break;
case"TRACKCHANGE_SUB":v="SUB";
break;
case"TRACKCHANGE_P":v="P";
break;
case"BOOKMARK":v="A";
break;
case"PLACEHOLDER":case"CAPTION":v="SPAN";
break;
default:break;
}return v;
};
var l=function(u,w){var v=u;
while(v&&v.nodeName!="BODY"){if(v.nodeName==w.toUpperCase()){break;
}v=v.parentNode;
}return v;
};
var j=function(z,C,u,A){z=c.DomRange.toDomRange(z);
var B={start:false,end:false,sameElement:false,startPartialRange:"",endPartialRange:""};
var v=z.cloneRange();
var x=z.cloneRange();
v.collapse(true);
if(v.range.move){v.range.move("character",1);
}x.collapse(false);
var w=v.getParentElement();
var y=x.getParentElement();
C=m(C);
if(w.nodeName!=C){if(u){w=l(w,C);
}}if(y.nodeName!=C){if(u){y=l(y,C);
}}if(typeof(A)!="undefined"||A!=null){B.start=(new RegExp(A,"i").test($telerik.getOuterHtml(w))&&w.nodeName==C);
B.end=(new RegExp(A,"i").test($telerik.getOuterHtml(y))&&y.nodeName==C);
}else{B.start=C==w.nodeName;
B.end=C==y.nodeName;
}B.sameElement=w==y;
v.moveEnd("character",1);
x.moveEnd("character",1);
B.startPartialRange=v;
B.endPartialRange=x;
z.select();
return B;
};
var n=function(A,D,y,B){A=c.DomRange.toDomRange(A);
var C=false;
var v=A.getParentElement();
var z=false;
if(D.match(/(placeholder|caption)/i)){D="A";
z=true;
}D=m(D);
if(v){if(v.nodeName!=D&&y){v=l(v,D);
}var w=A.cloneRange();
try{w.selectNodeContents(v);
}catch(x){}if(D==v.nodeName){if(new RegExp(B,"i").test(A.getHtml())){if(z){var u=$telerik.getOuterHtml(v).replace(/^\s+|\s+$/g,"");
if(A.getText()==u){C=true;
}}else{return A.inRange(w)||A.getText()==$telerik.getOuterHtml(v);
}}}}return C;
};
var s=function(x,A,v,y){x=c.DomRange.toDomRange(x);
var z=false;
var u=x.getParentElement();
A=m(A);
if(u.nodeName!=A.toUpperCase()){if(v){u=l(u,A);
}}if(u.nodeName==A){var w=(x.range&&x.range.moveEnd)||(!x.range&&x.moveEnd);
if(w){x.moveEnd("character",1);
}if(!new RegExp(y,"i").test(x.getHtml())&&new RegExp(y,"i").test($telerik.getOuterHtml(u))){z=true;
}if(w){x.moveEnd("character",-1);
}}return z;
};
var r=function(x,A,v,y){x=c.DomRange.toDomRange(x);
var z=false;
var u=x.getParentElement();
A=m(A);
if(u.nodeName!=A){if(v){u=l(u,A);
}}if(new RegExp(y,"i").test(x.getHtml())){var w=j(x,A,v,y);
if(w.start&&w.end&&w.sameElement){if($telerik.getOuterHtml(u)!=x.getText()){return true;
}}}return z;
};
var p=function(x,A,v,y){x=c.DomRange.toDomRange(x);
var z=false;
var u=x.getParentElement();
A=m(A);
if(u.nodeName!=A){if(v){u=l(u,A);
}}if(!new RegExp(y,"i").test(x.getHtml())){var w=j(x,A,v,y);
if(w.start&&w.end&&w.sameElement&&x.getText()!=$telerik.getOuterHtml(u)){return true;
}}return z;
};
var q=function(D,H,z,F){D=c.DomRange.toDomRange(D);
var G=false;
var v=H.toUpperCase();
H=m(H);
var E=D.getHtml();
if(new RegExp(F,"i").test(E)){var C=j(D,H,z,F);
if((C.start||C.end)&&(!C.sameElement)){G=true;
}else{if(v=="IMG"||v=="CAPTION"||v=="PLACEHOLDER"){var u=v=="IMG"?F:"(</?(A).*\n*contentEditable=.*[^>]*/?>)";
var B=E.match(new RegExp(u,"i"));
if(B){var A=B[0].length;
if(B.index==0&&A!=E.length){G=true;
}else{var w=D.cloneRange();
w.collapse(false);
if(w.range.moveStart){w.moveStart("character",-1);
}var x=w.getHtml();
if(x.match(new RegExp(u,"i"))){G=true;
}else{var y=w.getParentElement();
if(x==""&&y.nodeName=="A"&&y.contentEditable=="true"){G=true;
}}}}}}}return G;
};
var o=function(w,z,u,x){w=c.DomRange.toDomRange(w);
var y=false;
z=m(z);
if(new RegExp(x,"i").test(w.getHtml())){var v=j(w,z,u,x);
if(!v.start&&!v.end){return true;
}}return y;
};
var i=function(v,u){var w=v;
var x=w.parentElement;
if(x.nodeName=="FONT"){var z=c.Utils.getTextContent(w);
var y=x.outerText;
if(z==y){u.selectElement(x);
return;
}}var A=document.createElement("FONT");
w.parentElement.replaceChild(A,w);
A.appendChild(w);
u.selectElement(A);
};
var e=function(y,u){if(typeof(y)=="undefined"||y==null){return;
}var B=[];
var x=y;
var v=x.getAttribute(u);
var D=x.nodeName;
var C=x.ownerDocument.getElementsByTagName(D);
if(v==null){B=C;
}else{for(var A=0;
A<C.length;
A++){var z=C[A];
var w=z.getAttribute(u);
if(v==w){B.push(z);
}}}return B;
};
var h=function(u){var v=u;
var w=new RegExp("<(script)[^>]*?>(?:.|\n)*?</(script)>","ig");
v=v.replace(w,"");
v=v.replace(/<\s*ins(.|\n)*?>/gi,"");
v=v.replace(/<\s*\/\s*ins\s*.*?>/gi,"");
v=v.replace(/<\s*del(.|\n)*?>/gi,"");
v=v.replace(/<\s*\/\s*del\s*.*?>/gi,"");
var x="(</?(strong|em|u|sup|sub|font|p)[^>]*("+b.Attribute.Author+"|"+b.Attribute.Cite+")=?)";
if(new RegExp(x,"ig").test(v)){v=f(v,x);
}v=v.replace(/<FONT[^>]color=.*?>([\s\S]*?)<\/FONT[^>]*?>/ig,"$1");
return v;
};
var f=function(B,x){var y=document.createElement("DIV");
c.Utils.setElementInnerHtml(y,B);
var A=y.childNodes;
var w=x;
for(var v=0;
v<A.length;
v++){var z=A[v];
if(z.nodeName!="#text"){try{if(new RegExp(w,"ig").test($telerik.getOuterHtml(z))){z.removeAttribute("className");
z.removeAttribute(b.Attribute.Title);
z.removeAttribute(b.Attribute.Author);
z.removeAttribute(b.Attribute.Cite);
z.removeAttribute(b.Attribute.Timestamp);
z.removeAttribute(b.Attribute.BrowserCommand);
}}catch(u){continue;
}}}return y.innerHTML;
};
var g=function(v,x,z){var y=v;
var w=y.match(new RegExp(k(z),"i"));
if(w){y=u();
}return y;
function u(){var F=y;
var B=false;
F=F.replace(/<(p)[^>]*\/?><\/(?:\1)>/ig,"");
F=F.replace(/<(p)[^>]*\/?>&nbsp;<\/(?:\1)>/ig,"<BR/>");
F=F.replace(/<\s*p(.|\n)*?>/i,"");
F=F.replace(/<\s*\/\s*p\s*.*?>/ig,"");
F=F.replace(/<\s*p(.|\n)*?>/ig,"<BR/>");
var H=document.createElement("DIV");
c.Utils.setElementInnerHtml(H,F);
var E=true;
if(H.children.length==1&&H.childNodes.length==1){if(H.childNodes[0].nodeName=="SPAN"){F=c.Utils.getTextContent(H.childNodes[0]);
E=false;
}}if(E){var J=H.childNodes;
for(var C=0;
C<J.length;
C++){var I=J[C];
if(I.nodeName=="A"){var D=I.contentEditable.match(/(true|false)/i);
if(D){try{var K=x?document.createTextNode(""):document.createTextNode(I.outerText);
var G=I.parentElement;
G.replaceChild(K,I);
}catch(A){B=true;
}}}}if(!B){F=H.innerHTML;
}}return F;
}};
return{locateElementInRange:function(v,y,u,w){var v=c.DomRange.toDomRange(v),x=t(v.cloneRange(),y,u,w);
v.select();
return x;
},wrapElement:function(v,u){i(v,u);
},getSimilarElements:function(v,u){return e(v,u);
},stripTrackChanges:function(u){return h(u);
},findOffsetParent:function(u,x){var v=l(u,x);
var w=false;
if(v){if(v.nodeName==x.toUpperCase()){w=v;
}}return w;
},stripPlaceHolders:function(u,v,w){return g(u,v,w);
}};
})();
})(Telerik.Web.UI,$telerik.$,Telerik.Web.UI.Editor,Telerik.Web.UI.Editor.TrackChangesConstants);
